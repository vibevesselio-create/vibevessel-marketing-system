[
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/REMOVE_DUPLICATES-1016.py",
    "line_count": 2083,
    "imports": [
      "argparse",
      "collections",
      "csv",
      "dataclasses",
      "datetime",
      "difflib",
      "dotenv",
      "enum",
      "httpx",
      "importlib.util",
      "json",
      "logging",
      "notion_client",
      "notion_client.errors",
      "os",
      "pathlib",
      "random",
      "rapidfuzz.fuzz",
      "re",
      "sys",
      "time",
      "traceback",
      "types",
      "typing",
      "unicodedata",
      "urllib.parse"
    ],
    "functions": [
      {
        "name": "filter",
        "lineno": 54,
        "end_lineno": 59,
        "args": [
          "self",
          "record"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "fuzzy_ratio",
        "lineno": 76,
        "end_lineno": 77,
        "args": [
          "a",
          "b"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "fuzzy_ratio",
        "lineno": 80,
        "end_lineno": 81,
        "args": [
          "a",
          "b"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "setup_logging",
        "lineno": 114,
        "end_lineno": 125,
        "args": [
          "session_id",
          "enable_notion",
          "log_level"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_env_or_default",
        "lineno": 169,
        "end_lineno": 175,
        "args": [
          "key"
        ],
        "docstring": "Return environment value if present, otherwise the configured fallback.",
        "decorators": []
      },
      {
        "name": "_env_flag",
        "lineno": 177,
        "end_lineno": 187,
        "args": [
          "key"
        ],
        "docstring": "Resolve boolean env/CLI default with strict validation.",
        "decorators": []
      },
      {
        "name": "_normalize_label",
        "lineno": 189,
        "end_lineno": 192,
        "args": [
          "label"
        ],
        "docstring": "Lowercase label and strip non-alphanumerics for loose comparison.",
        "decorators": []
      },
      {
        "name": "_expand_variants",
        "lineno": 194,
        "end_lineno": 203,
        "args": [
          "labels"
        ],
        "docstring": "Expand label variants using synonyms",
        "decorators": []
      },
      {
        "name": "_normalize_uuid",
        "lineno": 205,
        "end_lineno": 217,
        "args": [
          "s"
        ],
        "docstring": "Normalize Notion UUID to 32-character format",
        "decorators": []
      },
      {
        "name": "_to_dashed_uuid",
        "lineno": 219,
        "end_lineno": 226,
        "args": [
          "hex32"
        ],
        "docstring": "Return dashed UUID form from a 32-character hex string",
        "decorators": []
      },
      {
        "name": "_emoji",
        "lineno": 228,
        "end_lineno": 231,
        "args": [
          "emoji_char",
          "text_fallback"
        ],
        "docstring": "Return emoji or text fallback based on PLAIN_LOGS setting.",
        "decorators": []
      },
      {
        "name": "_collect_property_entries",
        "lineno": 237,
        "end_lineno": 252,
        "args": [
          "props"
        ],
        "docstring": "Collect property entries with normalized variants",
        "decorators": []
      },
      {
        "name": "_score_entry",
        "lineno": 254,
        "end_lineno": 258,
        "args": [
          "entry",
          "preferred_variants"
        ],
        "docstring": "Score property entry for primary field selection",
        "decorators": []
      },
      {
        "name": "_resolve_primary_field",
        "lineno": 260,
        "end_lineno": 312,
        "args": [
          "props",
          "override",
          "logger"
        ],
        "docstring": "Resolve the primary field to use as title",
        "decorators": []
      },
      {
        "name": "_mask",
        "lineno": 266,
        "end_lineno": 271,
        "args": [
          "identifier"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_safe_get",
        "lineno": 318,
        "end_lineno": 325,
        "args": [
          "d",
          "keys",
          "default"
        ],
        "docstring": "Safely navigate nested dictionaries",
        "decorators": []
      },
      {
        "name": "_get_text_prop_from",
        "lineno": 327,
        "end_lineno": 346,
        "args": [
          "prop"
        ],
        "docstring": "Extract text from a property value",
        "decorators": []
      },
      {
        "name": "_get_text_prop",
        "lineno": 348,
        "end_lineno": 351,
        "args": [
          "entry",
          "name"
        ],
        "docstring": "Get text from a named property",
        "decorators": []
      },
      {
        "name": "_get_number_prop",
        "lineno": 353,
        "end_lineno": 356,
        "args": [
          "entry",
          "name"
        ],
        "docstring": "Get number from a named property",
        "decorators": []
      },
      {
        "name": "_get_url_prop",
        "lineno": 358,
        "end_lineno": 361,
        "args": [
          "entry",
          "name"
        ],
        "docstring": "Get URL from a named property",
        "decorators": []
      },
      {
        "name": "_duration_bucket",
        "lineno": 363,
        "end_lineno": 370,
        "args": [
          "seconds",
          "guard"
        ],
        "docstring": "Convert duration to bucket for approximate matching",
        "decorators": []
      },
      {
        "name": "_strip_bracketed",
        "lineno": 372,
        "end_lineno": 374,
        "args": [
          "s"
        ],
        "docstring": "Remove bracketed content from string",
        "decorators": []
      },
      {
        "name": "_extract_artist",
        "lineno": 376,
        "end_lineno": 382,
        "args": [
          "entry"
        ],
        "docstring": "Extract artist from common fields",
        "decorators": []
      },
      {
        "name": "_artist_schema_norm",
        "lineno": 384,
        "end_lineno": 396,
        "args": [
          "entry"
        ],
        "docstring": "Normalized artist for comparison",
        "decorators": []
      },
      {
        "name": "_extract_duration_seconds",
        "lineno": 398,
        "end_lineno": 416,
        "args": [
          "entry"
        ],
        "docstring": "Extract duration in seconds from properties",
        "decorators": []
      },
      {
        "name": "_dur_ok_entries",
        "lineno": 418,
        "end_lineno": 429,
        "args": [
          "a",
          "b",
          "tol"
        ],
        "docstring": "Check if two entries have similar durations",
        "decorators": []
      },
      {
        "name": "_do_not_merge",
        "lineno": 431,
        "end_lineno": 437,
        "args": [
          "entry"
        ],
        "docstring": "Check if entry has Do Not Merge flag",
        "decorators": []
      },
      {
        "name": "_parse_args",
        "lineno": 443,
        "end_lineno": 504,
        "args": [],
        "docstring": "Parse command line arguments",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 604,
        "end_lineno": 638,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "quick_verify_matching",
        "lineno": 640,
        "end_lineno": 688,
        "args": [
          "self",
          "max_batches",
          "batch_size"
        ],
        "docstring": "Quick verification harness (preserved from original)",
        "decorators": []
      },
      {
        "name": "_with_retries",
        "lineno": 690,
        "end_lineno": 712,
        "args": [
          "self",
          "fn",
          "*args",
          "_label",
          "_max",
          "_base_delay",
          "**kwargs"
        ],
        "docstring": "Call Notion client ops with 429-aware retries (preserved from original)",
        "decorators": []
      },
      {
        "name": "_api_request",
        "lineno": 714,
        "end_lineno": 723,
        "args": [
          "self",
          "method",
          "path",
          "body"
        ],
        "docstring": "Invoke raw Notion endpoints (preserved from original)",
        "decorators": []
      },
      {
        "name": "_api_get",
        "lineno": 725,
        "end_lineno": 727,
        "args": [
          "self",
          "path"
        ],
        "docstring": "Generic GET for endpoints",
        "decorators": []
      },
      {
        "name": "_api_post",
        "lineno": 729,
        "end_lineno": 731,
        "args": [
          "self",
          "path",
          "body"
        ],
        "docstring": "Generic POST for endpoints",
        "decorators": []
      },
      {
        "name": "_query_api",
        "lineno": 733,
        "end_lineno": 748,
        "args": [
          "self",
          "start_cursor",
          "page_size"
        ],
        "docstring": "Query using the stable databases endpoint (preserved from original)",
        "decorators": []
      },
      {
        "name": "_iso_to_dt",
        "lineno": 750,
        "end_lineno": 755,
        "args": [
          "self",
          "iso"
        ],
        "docstring": "Convert ISO string to datetime",
        "decorators": []
      },
      {
        "name": "_prop_type_map",
        "lineno": 757,
        "end_lineno": 759,
        "args": [
          "self",
          "db_info"
        ],
        "docstring": "Get property type map from database info",
        "decorators": []
      },
      {
        "name": "_nonempty",
        "lineno": 761,
        "end_lineno": 765,
        "args": [
          "self",
          "v"
        ],
        "docstring": "Check if value is non-empty",
        "decorators": []
      },
      {
        "name": "_pick_latest_nonempty",
        "lineno": 767,
        "end_lineno": 772,
        "args": [
          "self",
          "values",
          "page_times"
        ],
        "docstring": "Pick the latest non-empty value",
        "decorators": []
      },
      {
        "name": "_union_multi_select",
        "lineno": 774,
        "end_lineno": 783,
        "args": [
          "self",
          "vals"
        ],
        "docstring": "Union multi-select values",
        "decorators": []
      },
      {
        "name": "_union_ids",
        "lineno": 785,
        "end_lineno": 796,
        "args": [
          "self",
          "vals",
          "key"
        ],
        "docstring": "Union ID values",
        "decorators": []
      },
      {
        "name": "_union_files",
        "lineno": 798,
        "end_lineno": 836,
        "args": [
          "self",
          "vals"
        ],
        "docstring": "Union file values (preserved from original)",
        "decorators": []
      },
      {
        "name": "file_key",
        "lineno": 821,
        "end_lineno": 826,
        "args": [
          "f"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_merge_property",
        "lineno": 838,
        "end_lineno": 930,
        "args": [
          "self",
          "name",
          "prop_values",
          "page_times",
          "prop_types"
        ],
        "docstring": "Merge a single property (preserved from original with all logic)",
        "decorators": []
      },
      {
        "name": "_choose_keeper",
        "lineno": 932,
        "end_lineno": 948,
        "args": [
          "self",
          "group"
        ],
        "docstring": "Choose which entry to keep (preserved from original)",
        "decorators": []
      },
      {
        "name": "nonempty_count",
        "lineno": 934,
        "end_lineno": 941,
        "args": [
          "p"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_merge_group_into_keeper",
        "lineno": 950,
        "end_lineno": 1077,
        "args": [
          "self",
          "db_info",
          "group"
        ],
        "docstring": "Merge group into keeper (preserved from original with all functionality)",
        "decorators": []
      },
      {
        "name": "_write_rich_text_prop",
        "lineno": 1033,
        "end_lineno": 1040,
        "args": [
          "pid",
          "prop_name",
          "content"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_extract_title",
        "lineno": 1079,
        "end_lineno": 1107,
        "args": [
          "self",
          "entry"
        ],
        "docstring": "Extract title from entry (preserved from original with fallback logic)",
        "decorators": []
      },
      {
        "name": "_clean_title",
        "lineno": 1109,
        "end_lineno": 1117,
        "args": [
          "self",
          "s"
        ],
        "docstring": "Clean title for comparison (preserved from original)",
        "decorators": []
      },
      {
        "name": "_key_for",
        "lineno": 1119,
        "end_lineno": 1135,
        "args": [
          "self",
          "entry"
        ],
        "docstring": "Generate key for entry (preserved from original)",
        "decorators": []
      },
      {
        "name": "_extract_uuid_from_obj",
        "lineno": 1137,
        "end_lineno": 1169,
        "args": [
          "self",
          "obj"
        ],
        "docstring": "Extract UUID from object (preserved from original)",
        "decorators": []
      },
      {
        "name": "_normalize_candidate",
        "lineno": 1139,
        "end_lineno": 1145,
        "args": [
          "value"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_normalize_url",
        "lineno": 1172,
        "end_lineno": 1189,
        "args": [
          "value"
        ],
        "docstring": "Normalize URLs for comparison (preserved from original)",
        "decorators": [
          "staticmethod"
        ]
      },
      {
        "name": "_spotify_id_from_url",
        "lineno": 1192,
        "end_lineno": 1197,
        "args": [
          "url"
        ],
        "docstring": "Extract Spotify ID from URL (preserved from original)",
        "decorators": [
          "staticmethod"
        ]
      },
      {
        "name": "_norm",
        "lineno": 1199,
        "end_lineno": 1201,
        "args": [
          "self",
          "s"
        ],
        "docstring": "Normalize string",
        "decorators": []
      },
      {
        "name": "_artist_ok",
        "lineno": 1203,
        "end_lineno": 1209,
        "args": [
          "self",
          "a",
          "b"
        ],
        "docstring": "Check if artists match",
        "decorators": []
      },
      {
        "name": "_derive_track_id",
        "lineno": 1211,
        "end_lineno": 1230,
        "args": [
          "self",
          "entry"
        ],
        "docstring": "Derive track ID (preserved from original)",
        "decorators": []
      },
      {
        "name": "_state_push",
        "lineno": 1232,
        "end_lineno": 1261,
        "args": [
          "self",
          "entry",
          "status_note",
          "keeper_id"
        ],
        "docstring": "Update unified state registry (preserved from original)",
        "decorators": []
      },
      {
        "name": "_is_music_tracks_db",
        "lineno": 1263,
        "end_lineno": 1269,
        "args": [
          "self"
        ],
        "docstring": "Check if this is the Music Tracks DB (preserved from original)",
        "decorators": []
      },
      {
        "name": "_trigger_cross_platform_matcher",
        "lineno": 1271,
        "end_lineno": 1399,
        "args": [
          "self",
          "keeper",
          "dry_run"
        ],
        "docstring": "Trigger cross-platform matcher (preserved from original)",
        "decorators": []
      },
      {
        "name": "find_duplicates",
        "lineno": 1401,
        "end_lineno": 1709,
        "args": [
          "self",
          "entries"
        ],
        "docstring": "Find duplicates with URL priority matching (ENHANCED VERSION)",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 1463,
        "end_lineno": 1465,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "add",
        "lineno": 1467,
        "end_lineno": 1470,
        "args": [
          "self",
          "x"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "find",
        "lineno": 1472,
        "end_lineno": 1475,
        "args": [
          "self",
          "x"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "union",
        "lineno": 1477,
        "end_lineno": 1485,
        "args": [
          "self",
          "a",
          "b"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "register_group",
        "lineno": 1495,
        "end_lineno": 1502,
        "args": [
          "ids",
          "reason"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "conflicting_ids",
        "lineno": 1656,
        "end_lineno": 1680,
        "args": [
          "page_ids"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "collect",
        "lineno": 1657,
        "end_lineno": 1666,
        "args": [
          "name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "collect_num",
        "lineno": 1668,
        "end_lineno": 1676,
        "args": [
          "name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "fetch_database_entries",
        "lineno": 1711,
        "end_lineno": 1884,
        "args": [
          "self"
        ],
        "docstring": "Fetch all entries from database (preserved from original with all logic)",
        "decorators": []
      },
      {
        "name": "sort_key",
        "lineno": 1873,
        "end_lineno": 1875,
        "args": [
          "page"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_merge_blocks",
        "lineno": 1886,
        "end_lineno": 1931,
        "args": [
          "self",
          "keeper_id",
          "source_id"
        ],
        "docstring": "Merge blocks from source into keeper (preserved from original)",
        "decorators": []
      },
      {
        "name": "archive_duplicates",
        "lineno": 1933,
        "end_lineno": 1979,
        "args": [
          "self",
          "duplicates"
        ],
        "docstring": "Archive duplicate pages (preserved from original)",
        "decorators": []
      },
      {
        "name": "run",
        "lineno": 1981,
        "end_lineno": 2062,
        "args": [
          "self"
        ],
        "docstring": "Main execution method (preserved from original)",
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 2068,
        "end_lineno": 2080,
        "args": [],
        "docstring": "Main entry point (preserved from original)",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "SuppressNTNWarning",
        "lineno": 52,
        "end_lineno": 59,
        "docstring": "Suppress legacy 'ntn_' token-prefix warnings",
        "bases": [
          "logging.Filter"
        ]
      },
      {
        "name": "NotionDuplicateHandler",
        "lineno": 601,
        "end_lineno": 2062,
        "docstring": "Main handler class with all original functionality preserved",
        "bases": []
      },
      {
        "name": "UnionFind",
        "lineno": 1462,
        "end_lineno": 1485,
        "docstring": null,
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/auto_repair_system.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/comprehensive_metadata_and_tags_fix.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/comprehensive_workflow_orchestrator_fixed.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/comprehensive_workflow_orchestrator_optimized.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/database_workflow_manager.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_client 2.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_client.py",
    "error": "SyntaxError: expected an indented block after 'try' statement on line 99 (<unknown>, line 100)"
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_orchestrator.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_playlist_processor.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_playlist_processor_automated.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_playlist_processor_with_state_tracking.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_production_builder.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_state_tracker.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/enhanced_sync_system_v2.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/json_spotify_processor.py",
    "line_count": 1145,
    "imports": [
      "argparse",
      "dataclasses",
      "datetime",
      "enum",
      "hashlib",
      "html",
      "json",
      "logging",
      "logging.handlers",
      "os",
      "pathlib",
      "re",
      "requests",
      "shutil",
      "sys",
      "time",
      "typing"
    ],
    "functions": [
      {
        "name": "save_to_file",
        "lineno": 60,
        "end_lineno": 66,
        "args": [
          "self",
          "filepath"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "load_from_file",
        "lineno": 69,
        "end_lineno": 74,
        "args": [
          "cls",
          "filepath"
        ],
        "docstring": null,
        "decorators": [
          "classmethod"
        ]
      },
      {
        "name": "__post_init__",
        "lineno": 94,
        "end_lineno": 98,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__post_init__",
        "lineno": 112,
        "end_lineno": 118,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__post_init__",
        "lineno": 137,
        "end_lineno": 143,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 146,
        "end_lineno": 156,
        "args": [
          "self",
          "token",
          "parent_page_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_make_request",
        "lineno": 158,
        "end_lineno": 187,
        "args": [
          "self",
          "method",
          "endpoint",
          "data",
          "retries"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "query_database",
        "lineno": 189,
        "end_lineno": 210,
        "args": [
          "self",
          "db_id",
          "filter_query",
          "page_size"
        ],
        "docstring": "Query database with pagination support",
        "decorators": []
      },
      {
        "name": "create_page",
        "lineno": 212,
        "end_lineno": 214,
        "args": [
          "self",
          "db_id",
          "properties"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "update_page",
        "lineno": 216,
        "end_lineno": 217,
        "args": [
          "self",
          "page_id",
          "properties"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_database_schema",
        "lineno": 219,
        "end_lineno": 220,
        "args": [
          "self",
          "db_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "update_database",
        "lineno": 222,
        "end_lineno": 224,
        "args": [
          "self",
          "db_id",
          "properties"
        ],
        "docstring": "Update database schema",
        "decorators": []
      },
      {
        "name": "search_for_database",
        "lineno": 226,
        "end_lineno": 232,
        "args": [
          "self",
          "title"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "validate_database_access",
        "lineno": 234,
        "end_lineno": 235,
        "args": [
          "self",
          "db_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 238,
        "end_lineno": 268,
        "args": [
          "self",
          "notion_token",
          "db_ids",
          "parent_page_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_initialize_databases",
        "lineno": 270,
        "end_lineno": 327,
        "args": [
          "self"
        ],
        "docstring": "Ensure all databases exist and have proper schemas",
        "decorators": []
      },
      {
        "name": "_ensure_track_properties",
        "lineno": 329,
        "end_lineno": 379,
        "args": [
          "self"
        ],
        "docstring": "Ensure all required properties exist in tracks database",
        "decorators": []
      },
      {
        "name": "_ensure_artist_properties",
        "lineno": 381,
        "end_lineno": 407,
        "args": [
          "self"
        ],
        "docstring": "Ensure all required properties exist in artists database",
        "decorators": []
      },
      {
        "name": "_ensure_playlist_properties",
        "lineno": 409,
        "end_lineno": 447,
        "args": [
          "self"
        ],
        "docstring": "Ensure all required properties exist in playlists database",
        "decorators": []
      },
      {
        "name": "sync_artist_to_notion",
        "lineno": 449,
        "end_lineno": 504,
        "args": [
          "self",
          "artist_data"
        ],
        "docstring": "Sync artist data to Notion",
        "decorators": []
      },
      {
        "name": "sync_track_to_notion",
        "lineno": 506,
        "end_lineno": 588,
        "args": [
          "self",
          "track_data",
          "artist_notion_id"
        ],
        "docstring": "Sync track data to Notion",
        "decorators": []
      },
      {
        "name": "sync_playlist_to_notion",
        "lineno": 590,
        "end_lineno": 684,
        "args": [
          "self",
          "playlist_data"
        ],
        "docstring": "Sync playlist data to Notion",
        "decorators": []
      },
      {
        "name": "_is_track_data",
        "lineno": 686,
        "end_lineno": 700,
        "args": [
          "self",
          "data"
        ],
        "docstring": "Check if data represents a single track",
        "decorators": []
      },
      {
        "name": "clean_html",
        "lineno": 702,
        "end_lineno": 710,
        "args": [
          "self",
          "text"
        ],
        "docstring": "Remove HTML tags and decode HTML entities",
        "decorators": []
      },
      {
        "name": "detect_source_from_data",
        "lineno": 712,
        "end_lineno": 740,
        "args": [
          "self",
          "data"
        ],
        "docstring": "Detect whether data is from SoundCloud or Spotify based on content",
        "decorators": []
      },
      {
        "name": "extract_hybrid_playlist",
        "lineno": 742,
        "end_lineno": 802,
        "args": [
          "self",
          "data",
          "source"
        ],
        "docstring": "Extract playlist data from hybrid format (Spotify data in SoundCloud structure)",
        "decorators": []
      },
      {
        "name": "extract_soundcloud_playlist",
        "lineno": 804,
        "end_lineno": 829,
        "args": [
          "self",
          "data"
        ],
        "docstring": "Extract playlist data from SoundCloud JSON",
        "decorators": []
      },
      {
        "name": "extract_soundcloud_track",
        "lineno": 831,
        "end_lineno": 848,
        "args": [
          "self",
          "data"
        ],
        "docstring": "Extract track data from SoundCloud JSON",
        "decorators": []
      },
      {
        "name": "extract_spotify_playlist",
        "lineno": 850,
        "end_lineno": 870,
        "args": [
          "self",
          "data"
        ],
        "docstring": "Extract playlist data from Spotify JSON",
        "decorators": []
      },
      {
        "name": "extract_spotify_track",
        "lineno": 872,
        "end_lineno": 904,
        "args": [
          "self",
          "data"
        ],
        "docstring": "Extract track data from Spotify JSON",
        "decorators": []
      },
      {
        "name": "extract_spotify_artist",
        "lineno": 906,
        "end_lineno": 921,
        "args": [
          "self",
          "data"
        ],
        "docstring": "Extract artist data from Spotify JSON",
        "decorators": []
      },
      {
        "name": "process_json_file",
        "lineno": 923,
        "end_lineno": 1020,
        "args": [
          "self",
          "filepath"
        ],
        "docstring": "Process a single JSON file",
        "decorators": []
      },
      {
        "name": "process_directory",
        "lineno": 1022,
        "end_lineno": 1049,
        "args": [
          "self",
          "directory"
        ],
        "docstring": "Process all JSON files in a directory",
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 1051,
        "end_lineno": 1142,
        "args": [],
        "docstring": null,
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "ProcessingMode",
        "lineno": 47,
        "end_lineno": 50,
        "docstring": null,
        "bases": [
          "Enum"
        ]
      },
      {
        "name": "NotionDatabaseIDs",
        "lineno": 53,
        "end_lineno": 74,
        "docstring": null,
        "bases": []
      },
      {
        "name": "TrackData",
        "lineno": 77,
        "end_lineno": 98,
        "docstring": null,
        "bases": []
      },
      {
        "name": "ArtistData",
        "lineno": 101,
        "end_lineno": 118,
        "docstring": null,
        "bases": []
      },
      {
        "name": "PlaylistData",
        "lineno": 121,
        "end_lineno": 143,
        "docstring": null,
        "bases": []
      },
      {
        "name": "NotionAPIClient",
        "lineno": 145,
        "end_lineno": 235,
        "docstring": null,
        "bases": []
      },
      {
        "name": "JSONProcessor",
        "lineno": 237,
        "end_lineno": 1049,
        "docstring": null,
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/matching_engine.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/music_metadata_population.py",
    "line_count": 652,
    "imports": [
      "datetime",
      "difflib",
      "dotenv",
      "framework.interaction_logger",
      "framework.mcp_connector",
      "json",
      "logging",
      "os",
      "re",
      "requests",
      "time",
      "typing"
    ],
    "functions": [
      {
        "name": "__init__",
        "lineno": 28,
        "end_lineno": 56,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "setup_logging",
        "lineno": 58,
        "end_lineno": 73,
        "args": [
          "self"
        ],
        "docstring": "Setup comprehensive logging for the music metadata population process.",
        "decorators": []
      },
      {
        "name": "create_script_run_log",
        "lineno": 75,
        "end_lineno": 95,
        "args": [
          "self"
        ],
        "docstring": "Create a script run log entry in Notion.",
        "decorators": []
      },
      {
        "name": "update_script_run_log",
        "lineno": 97,
        "end_lineno": 116,
        "args": [
          "self",
          "status",
          "results"
        ],
        "docstring": "Update the script run log with current status and results.",
        "decorators": []
      },
      {
        "name": "get_spotify_token",
        "lineno": 118,
        "end_lineno": 153,
        "args": [
          "self"
        ],
        "docstring": "Get Spotify access token using client credentials flow.",
        "decorators": []
      },
      {
        "name": "search_spotify_track",
        "lineno": 155,
        "end_lineno": 211,
        "args": [
          "self",
          "artist",
          "track_name",
          "album"
        ],
        "docstring": "Search for a track on Spotify.",
        "decorators": []
      },
      {
        "name": "find_best_spotify_match",
        "lineno": 213,
        "end_lineno": 265,
        "args": [
          "self",
          "tracks",
          "artist",
          "track_name",
          "album"
        ],
        "docstring": "Find the best matching track from Spotify search results.",
        "decorators": []
      },
      {
        "name": "search_soundcloud_track",
        "lineno": 267,
        "end_lineno": 309,
        "args": [
          "self",
          "artist",
          "track_name"
        ],
        "docstring": "Search for a track on SoundCloud.",
        "decorators": []
      },
      {
        "name": "find_best_soundcloud_match",
        "lineno": 311,
        "end_lineno": 355,
        "args": [
          "self",
          "tracks",
          "artist",
          "track_name"
        ],
        "docstring": "Find the best matching track from SoundCloud search results.",
        "decorators": []
      },
      {
        "name": "fuzzy_match",
        "lineno": 357,
        "end_lineno": 363,
        "args": [
          "self",
          "str1",
          "str2"
        ],
        "docstring": "Calculate fuzzy match similarity between two strings.",
        "decorators": []
      },
      {
        "name": "get_music_tracks_missing_metadata",
        "lineno": 365,
        "end_lineno": 423,
        "args": [
          "self"
        ],
        "docstring": "Query the music tracks database for records missing SoundCloud or Spotify metadata.",
        "decorators": []
      },
      {
        "name": "update_track_metadata",
        "lineno": 425,
        "end_lineno": 465,
        "args": [
          "self",
          "page_id",
          "spotify_data",
          "soundcloud_data"
        ],
        "docstring": "Update a track's metadata in Notion with found SoundCloud and Spotify data.",
        "decorators": []
      },
      {
        "name": "process_track",
        "lineno": 467,
        "end_lineno": 512,
        "args": [
          "self",
          "track"
        ],
        "docstring": "Process a single track to find and update missing metadata.",
        "decorators": []
      },
      {
        "name": "extract_property_text",
        "lineno": 514,
        "end_lineno": 527,
        "args": [
          "self",
          "property_data"
        ],
        "docstring": "Extract text content from Notion property data.",
        "decorators": []
      },
      {
        "name": "run_metadata_population",
        "lineno": 529,
        "end_lineno": 623,
        "args": [
          "self"
        ],
        "docstring": "Run the complete music metadata population process.",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "MusicMetadataPopulation",
        "lineno": 27,
        "end_lineno": 623,
        "docstring": null,
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/music_metadata_updater.py",
    "line_count": 562,
    "imports": [
      "colorama",
      "datetime",
      "difflib",
      "dotenv",
      "json",
      "logging",
      "os",
      "requests",
      "time",
      "typing"
    ],
    "functions": [
      {
        "name": "__init__",
        "lineno": 42,
        "end_lineno": 73,
        "args": [
          "self"
        ],
        "docstring": "Initialize the updater with API credentials and configuration.",
        "decorators": []
      },
      {
        "name": "validate_configuration",
        "lineno": 75,
        "end_lineno": 90,
        "args": [
          "self"
        ],
        "docstring": "Validate that all required configuration is present.",
        "decorators": []
      },
      {
        "name": "authenticate_apis",
        "lineno": 92,
        "end_lineno": 121,
        "args": [
          "self"
        ],
        "docstring": "Authenticate with Spotify and SoundCloud APIs.",
        "decorators": []
      },
      {
        "name": "get_notion_tracks",
        "lineno": 123,
        "end_lineno": 172,
        "args": [
          "self",
          "limit"
        ],
        "docstring": "Retrieve music tracks from Notion database that need metadata updates.",
        "decorators": []
      },
      {
        "name": "parse_notion_page",
        "lineno": 174,
        "end_lineno": 202,
        "args": [
          "self",
          "page"
        ],
        "docstring": "Parse a Notion page into a track dictionary.",
        "decorators": []
      },
      {
        "name": "get_property_value",
        "lineno": 204,
        "end_lineno": 221,
        "args": [
          "self",
          "properties",
          "property_name",
          "property_type"
        ],
        "docstring": "Extract value from a Notion property.",
        "decorators": []
      },
      {
        "name": "search_spotify",
        "lineno": 223,
        "end_lineno": 281,
        "args": [
          "self",
          "track_name",
          "artist_name"
        ],
        "docstring": "Search for a track on Spotify.",
        "decorators": []
      },
      {
        "name": "search_soundcloud",
        "lineno": 283,
        "end_lineno": 337,
        "args": [
          "self",
          "track_name",
          "artist_name"
        ],
        "docstring": "Search for a track on SoundCloud.",
        "decorators": []
      },
      {
        "name": "update_notion_track",
        "lineno": 339,
        "end_lineno": 369,
        "args": [
          "self",
          "track_id",
          "updates"
        ],
        "docstring": "Update a track in Notion with new metadata.",
        "decorators": []
      },
      {
        "name": "process_track",
        "lineno": 371,
        "end_lineno": 431,
        "args": [
          "self",
          "track"
        ],
        "docstring": "Process a single track to find and update metadata.",
        "decorators": []
      },
      {
        "name": "process_batch",
        "lineno": 433,
        "end_lineno": 444,
        "args": [
          "self",
          "tracks"
        ],
        "docstring": "Process a batch of tracks.",
        "decorators": []
      },
      {
        "name": "generate_report",
        "lineno": 446,
        "end_lineno": 473,
        "args": [
          "self",
          "results"
        ],
        "docstring": "Generate a comprehensive report of the processing results.",
        "decorators": []
      },
      {
        "name": "save_report",
        "lineno": 475,
        "end_lineno": 486,
        "args": [
          "self",
          "report",
          "filename"
        ],
        "docstring": "Save the processing report to a JSON file.",
        "decorators": []
      },
      {
        "name": "print_summary",
        "lineno": 488,
        "end_lineno": 518,
        "args": [
          "self",
          "report"
        ],
        "docstring": "Print a summary of the processing results.",
        "decorators": []
      },
      {
        "name": "run",
        "lineno": 520,
        "end_lineno": 546,
        "args": [
          "self",
          "limit"
        ],
        "docstring": "Main execution method.",
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 548,
        "end_lineno": 559,
        "args": [],
        "docstring": "Main entry point.",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "MusicMetadataUpdater",
        "lineno": 39,
        "end_lineno": 546,
        "docstring": "Main class for updating music metadata in Notion from external APIs.",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/music_workflow_automation.py",
    "line_count": 610,
    "imports": [
      "argparse",
      "dataclasses",
      "datetime",
      "difflib",
      "dotenv",
      "hashlib",
      "json",
      "logging",
      "notion_client",
      "os",
      "pathlib",
      "requests",
      "spotipy",
      "spotipy.oauth2",
      "sys",
      "time",
      "typing"
    ],
    "functions": [
      {
        "name": "__post_init__",
        "lineno": 77,
        "end_lineno": 79,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 84,
        "end_lineno": 92,
        "args": [
          "self",
          "client_id",
          "client_secret",
          "redirect_uri"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_track_safely",
        "lineno": 94,
        "end_lineno": 104,
        "args": [
          "self",
          "track_id"
        ],
        "docstring": "Get track with automatic token refresh",
        "decorators": []
      },
      {
        "name": "get_artist_genres",
        "lineno": 106,
        "end_lineno": 113,
        "args": [
          "self",
          "artist_id"
        ],
        "docstring": "Get genres for an artist",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 118,
        "end_lineno": 122,
        "args": [
          "self",
          "client_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "search_track_safely",
        "lineno": 124,
        "end_lineno": 157,
        "args": [
          "self",
          "query"
        ],
        "docstring": "Search with rate limiting and retry logic",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 162,
        "end_lineno": 163,
        "args": [
          "self",
          "token"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "query_database_with_filters",
        "lineno": 165,
        "end_lineno": 175,
        "args": [
          "self",
          "database_id",
          "filters"
        ],
        "docstring": "Query database with filters",
        "decorators": []
      },
      {
        "name": "update_page_properties",
        "lineno": 177,
        "end_lineno": 183,
        "args": [
          "self",
          "page_id",
          "properties"
        ],
        "docstring": "Update page properties",
        "decorators": []
      },
      {
        "name": "get_page",
        "lineno": 185,
        "end_lineno": 191,
        "args": [
          "self",
          "page_id"
        ],
        "docstring": "Get page by ID",
        "decorators": []
      },
      {
        "name": "verify_api_connections",
        "lineno": 193,
        "end_lineno": 235,
        "args": [],
        "docstring": "Test all API connections before running main workflow",
        "decorators": []
      },
      {
        "name": "get_first_testable_track",
        "lineno": 237,
        "end_lineno": 259,
        "args": [
          "notion_manager"
        ],
        "docstring": "Define filter criteria for selecting the first track to test",
        "decorators": []
      },
      {
        "name": "gather_track_metadata",
        "lineno": 261,
        "end_lineno": 318,
        "args": [
          "track",
          "spotify_manager",
          "soundcloud_manager"
        ],
        "docstring": "Gather metadata from Spotify and SoundCloud for a track",
        "decorators": []
      },
      {
        "name": "find_relevant_playlists_for_track",
        "lineno": 320,
        "end_lineno": 369,
        "args": [
          "metadata",
          "notion_manager"
        ],
        "docstring": "Find relevant playlists for a track based on its metadata",
        "decorators": []
      },
      {
        "name": "populate_playlist_relations_safely",
        "lineno": 371,
        "end_lineno": 406,
        "args": [
          "track_page_id",
          "playlist_ids",
          "notion_manager"
        ],
        "docstring": "Safely populate playlist relations with proper error handling",
        "decorators": []
      },
      {
        "name": "test_comprehensive_workflow",
        "lineno": 408,
        "end_lineno": 493,
        "args": [],
        "docstring": "Test complete workflow on first filtered track",
        "decorators": []
      },
      {
        "name": "process_tracks_batch",
        "lineno": 495,
        "end_lineno": 562,
        "args": [
          "batch_size"
        ],
        "docstring": "Process a batch of tracks",
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 564,
        "end_lineno": 607,
        "args": [],
        "docstring": "Main function",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "TrackMetadata",
        "lineno": 63,
        "end_lineno": 79,
        "docstring": "Track metadata from various sources",
        "bases": []
      },
      {
        "name": "SpotifyManager",
        "lineno": 81,
        "end_lineno": 113,
        "docstring": "Manages Spotify API interactions with automatic token refresh",
        "bases": []
      },
      {
        "name": "SoundCloudManager",
        "lineno": 115,
        "end_lineno": 157,
        "docstring": "Manages SoundCloud API interactions with rate limiting",
        "bases": []
      },
      {
        "name": "NotionManager",
        "lineno": 159,
        "end_lineno": 191,
        "docstring": "Manages Notion API interactions",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/notion_integration.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/notion_integration_fixed.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/notion_relation_populator.py",
    "line_count": 1152,
    "imports": [
      "argparse",
      "asyncio",
      "backoff",
      "collections",
      "concurrent.futures",
      "dataclasses",
      "datetime",
      "dotenv",
      "json",
      "logging",
      "logs.automation.workflows.base_workflow",
      "logs.core.apis.notion_integration",
      "notion_client",
      "os",
      "pathlib",
      "prometheus_client",
      "re",
      "shared.config",
      "shared.error_handling",
      "shared.logging",
      "src.env_manager",
      "sys",
      "tenacity",
      "time",
      "traceback",
      "typing"
    ],
    "functions": [
      {
        "name": "retry",
        "lineno": 64,
        "end_lineno": 67,
        "args": [
          "**kwargs"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "decorator",
        "lineno": 65,
        "end_lineno": 66,
        "args": [
          "func"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "to_dict",
        "lineno": 94,
        "end_lineno": 95,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 234,
        "end_lineno": 271,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "record_document_processed",
        "lineno": 273,
        "end_lineno": 279,
        "args": [
          "self",
          "tier",
          "relation_type",
          "status"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "record_relation_populated",
        "lineno": 281,
        "end_lineno": 288,
        "args": [
          "self",
          "relation_type",
          "confidence"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "record_error",
        "lineno": 290,
        "end_lineno": 292,
        "args": [
          "self",
          "error_type",
          "relation_type"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_performance_summary",
        "lineno": 294,
        "end_lineno": 314,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 319,
        "end_lineno": 323,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "load_relation_context",
        "lineno": 325,
        "end_lineno": 360,
        "args": [
          "self",
          "notion_client",
          "database_ids"
        ],
        "docstring": "Build context maps from existing relation databases",
        "async": true,
        "decorators": []
      },
      {
        "name": "_query_database_with_pagination",
        "lineno": 362,
        "end_lineno": 393,
        "args": [
          "self",
          "client",
          "database_id"
        ],
        "docstring": "Query database with pagination support",
        "async": true,
        "decorators": []
      },
      {
        "name": "_extract_page_title",
        "lineno": 395,
        "end_lineno": 406,
        "args": [
          "self",
          "page"
        ],
        "docstring": "Extract title from Notion page",
        "decorators": []
      },
      {
        "name": "_extract_page_description",
        "lineno": 408,
        "end_lineno": 420,
        "args": [
          "self",
          "page"
        ],
        "docstring": "Extract description from Notion page",
        "decorators": []
      },
      {
        "name": "_extract_keywords",
        "lineno": 422,
        "end_lineno": 427,
        "args": [
          "self",
          "name",
          "description"
        ],
        "docstring": "Extract keywords from name and description",
        "decorators": []
      },
      {
        "name": "_generate_synonyms",
        "lineno": 429,
        "end_lineno": 440,
        "args": [
          "self",
          "name"
        ],
        "docstring": "Generate synonyms for relation names",
        "decorators": []
      },
      {
        "name": "analyze_document_with_context",
        "lineno": 442,
        "end_lineno": 498,
        "args": [
          "self",
          "document",
          "relation_type"
        ],
        "docstring": "Comprehensive document analysis with multiple strategies",
        "decorators": []
      },
      {
        "name": "_pattern_based_analysis",
        "lineno": 500,
        "end_lineno": 531,
        "args": [
          "self",
          "content",
          "relation_type"
        ],
        "docstring": "Pattern-based analysis using regex patterns",
        "decorators": []
      },
      {
        "name": "_context_based_analysis",
        "lineno": 533,
        "end_lineno": 571,
        "args": [
          "self",
          "content",
          "relation_type"
        ],
        "docstring": "Context-based analysis using existing relation database content",
        "decorators": []
      },
      {
        "name": "_semantic_similarity_analysis",
        "lineno": 573,
        "end_lineno": 594,
        "args": [
          "self",
          "content",
          "relation_type"
        ],
        "docstring": "Semantic similarity analysis using context keywords",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 599,
        "end_lineno": 655,
        "args": [
          "self",
          "correlation_id",
          "**kwargs"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "initialize",
        "lineno": 657,
        "end_lineno": 667,
        "args": [
          "self"
        ],
        "docstring": "Initialize the populator components",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_unpopulated_documents",
        "lineno": 669,
        "end_lineno": 713,
        "args": [
          "self"
        ],
        "docstring": "Get documents with unpopulated relations using pagination",
        "async": true,
        "decorators": []
      },
      {
        "name": "_build_unpopulated_filter",
        "lineno": 715,
        "end_lineno": 736,
        "args": [
          "self"
        ],
        "docstring": "Build filter for documents with unpopulated relations",
        "decorators": []
      },
      {
        "name": "process_relation_type",
        "lineno": 738,
        "end_lineno": 802,
        "args": [
          "self",
          "documents",
          "relation_type"
        ],
        "docstring": "Process documents for a specific relation type",
        "async": true,
        "decorators": []
      },
      {
        "name": "_process_batch",
        "lineno": 804,
        "end_lineno": 898,
        "args": [
          "self",
          "batch",
          "relation_type",
          "config"
        ],
        "docstring": "Process a batch of documents for a specific relation type",
        "async": true,
        "decorators": []
      },
      {
        "name": "_is_relation_populated",
        "lineno": 900,
        "end_lineno": 909,
        "args": [
          "self",
          "document",
          "relation_type"
        ],
        "docstring": "Check if relation is already populated",
        "decorators": []
      },
      {
        "name": "_matches_to_relation_urls",
        "lineno": 911,
        "end_lineno": 932,
        "args": [
          "self",
          "matches",
          "relation_type"
        ],
        "docstring": "Convert pattern matches to actual relation page URLs",
        "decorators": []
      },
      {
        "name": "_update_document_relation",
        "lineno": 934,
        "end_lineno": 994,
        "args": [
          "self",
          "document",
          "relation_type",
          "relation_urls",
          "confidence",
          "metadata"
        ],
        "docstring": "Update document with relation data",
        "async": true,
        "decorators": []
      },
      {
        "name": "_extract_document_title",
        "lineno": 996,
        "end_lineno": 1007,
        "args": [
          "self",
          "document"
        ],
        "docstring": "Extract document title",
        "decorators": []
      },
      {
        "name": "_save_processing_state",
        "lineno": 1009,
        "end_lineno": 1021,
        "args": [
          "self",
          "state_data"
        ],
        "docstring": "Save processing state for recovery",
        "async": true,
        "decorators": []
      },
      {
        "name": "_restore_state",
        "lineno": 1023,
        "end_lineno": 1035,
        "args": [
          "self"
        ],
        "docstring": "Restore processing state from previous run",
        "async": true,
        "decorators": []
      },
      {
        "name": "_save_update_record",
        "lineno": 1037,
        "end_lineno": 1053,
        "args": [
          "self",
          "update_data"
        ],
        "docstring": "Save record of successful updates",
        "async": true,
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 1055,
        "end_lineno": 1149,
        "args": [],
        "docstring": "Main execution function",
        "async": true,
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "SerenError",
        "lineno": 53,
        "end_lineno": 54,
        "docstring": null,
        "bases": [
          "Exception"
        ]
      },
      {
        "name": "RelationConfig",
        "lineno": 85,
        "end_lineno": 95,
        "docstring": "Configuration for each relation type",
        "bases": []
      },
      {
        "name": "ProductionMetrics",
        "lineno": 231,
        "end_lineno": 314,
        "docstring": "Production metrics collection and monitoring",
        "bases": []
      },
      {
        "name": "IntelligentPatternMatcher",
        "lineno": 316,
        "end_lineno": 594,
        "docstring": "Advanced pattern matching with context awareness",
        "bases": []
      },
      {
        "name": "ProductionNotionRelationPopulator",
        "lineno": 596,
        "end_lineno": 1053,
        "docstring": "Production-ready relation populator",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/pipeline.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/production_music_sync_demo.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/seren_autonomous_scripting_system_v7.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/single_track_orchestrator.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/single_track_workflow.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/soundcloud_download_aligned.py",
    "line_count": 3786,
    "imports": [
      "argparse",
      "audio_normalizer",
      "audio_normalizer.notion_integration",
      "cProfile",
      "concurrent.futures",
      "datetime",
      "dotenv",
      "glob",
      "hashlib",
      "json",
      "librosa",
      "logging",
      "notion_client",
      "numpy",
      "os",
      "pathlib",
      "random",
      "re",
      "requests",
      "send2trash",
      "shutil",
      "soundfile",
      "subprocess",
      "sys",
      "tempfile",
      "threading",
      "time",
      "traceback",
      "typing",
      "urllib.parse",
      "yt_dlp"
    ],
    "functions": [
      {
        "name": "analyze_audio_loudness",
        "lineno": 69,
        "end_lineno": 110,
        "args": [
          "audio_samples",
          "sample_rate"
        ],
        "docstring": "Analyze audio loudness using RMS and peak measurements (LUFS approximation).\nBased on Platinum Notes loudness analysis approach.",
        "decorators": []
      },
      {
        "name": "detect_and_repair_clipping",
        "lineno": 112,
        "end_lineno": 154,
        "args": [
          "audio_samples",
          "threshold"
        ],
        "docstring": "Detect and repair clipped peaks using smoothing interpolation.\nBased on Platinum Notes clipping repair approach.",
        "decorators": []
      },
      {
        "name": "apply_warmth_saturation",
        "lineno": 156,
        "end_lineno": 192,
        "args": [
          "audio_samples",
          "mode"
        ],
        "docstring": "Apply harmonic saturation for warmth enhancement.\nBased on Platinum Notes warmth/saturation stage.",
        "decorators": []
      },
      {
        "name": "apply_loudness_normalization",
        "lineno": 194,
        "end_lineno": 254,
        "args": [
          "audio_samples",
          "target_lufs",
          "sample_rate"
        ],
        "docstring": "Apply bidirectional LUFS-based loudness normalization optimized for club playback.\n\nTarget: -8 LUFS for club-ready tracks with -1 dBTP true peak ceiling.\nHandles both quiet tracks (boost) and loud tracks (attenuate).",
        "decorators": []
      },
      {
        "name": "normalize_audio_platinum_notes_style",
        "lineno": 256,
        "end_lineno": 332,
        "args": [
          "audio_samples",
          "sample_rate",
          "target_lufs",
          "warmth_mode"
        ],
        "docstring": "Complete Platinum Notes-style audio normalization pipeline.\n\nSteps:\n1. Analyze current audio characteristics\n2. Detect and repair clipping\n3. Apply warmth/saturation\n4. Apply loudness normalization with limiting\n5. Final quality check\n\nReturns:\n    tuple: (normalized_audio_samples, processing_report)",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 401,
        "end_lineno": 404,
        "args": [
          "self",
          "script_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "setup_logging",
        "lineno": 406,
        "end_lineno": 418,
        "args": [
          "self"
        ],
        "docstring": "Setup logging following workspace standards",
        "decorators": []
      },
      {
        "name": "info",
        "lineno": 420,
        "end_lineno": 425,
        "args": [
          "self",
          "message",
          "*args"
        ],
        "docstring": "Log info message",
        "decorators": []
      },
      {
        "name": "warning",
        "lineno": 427,
        "end_lineno": 432,
        "args": [
          "self",
          "message",
          "*args"
        ],
        "docstring": "Log warning message",
        "decorators": []
      },
      {
        "name": "error",
        "lineno": 434,
        "end_lineno": 439,
        "args": [
          "self",
          "message",
          "*args"
        ],
        "docstring": "Log error message",
        "decorators": []
      },
      {
        "name": "debug",
        "lineno": 441,
        "end_lineno": 446,
        "args": [
          "self",
          "message",
          "*args"
        ],
        "docstring": "Log debug message",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 457,
        "end_lineno": 463,
        "args": [
          "self",
          "token"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_req",
        "lineno": 465,
        "end_lineno": 484,
        "args": [
          "self",
          "method",
          "path",
          "body",
          "retry"
        ],
        "docstring": "Make API request with retry logic following workspace standards",
        "decorators": []
      },
      {
        "name": "query_database",
        "lineno": 486,
        "end_lineno": 492,
        "args": [
          "self",
          "database_id",
          "query"
        ],
        "docstring": "Query database with workspace-standard error handling",
        "decorators": []
      },
      {
        "name": "update_page",
        "lineno": 494,
        "end_lineno": 500,
        "args": [
          "self",
          "page_id",
          "properties"
        ],
        "docstring": "Update page with workspace-standard error handling",
        "decorators": []
      },
      {
        "name": "_get_tracks_db_props",
        "lineno": 508,
        "end_lineno": 519,
        "args": [],
        "docstring": "Fetch and cache the property names in the Tracks database.",
        "decorators": []
      },
      {
        "name": "find_next_track",
        "lineno": 521,
        "end_lineno": 580,
        "args": [],
        "docstring": "Query the Music Tracks database for the newest item that meets criteria:\n- SoundCloud URL is not empty\n- M4A File Path, WAV File Path, and AIFF File Path are all empty\n- Downloaded checkbox is unchecked",
        "decorators": []
      },
      {
        "name": "find_all_tracks_for_processing",
        "lineno": 582,
        "end_lineno": 641,
        "args": [
          "limit"
        ],
        "docstring": "Query the Music Tracks database for ALL items that meet criteria:\n- SoundCloud URL is not empty\n- M4A File Path, WAV File Path, and AIFF File Path are all empty\n- Downloaded checkbox is unchecked\n\nArgs:\n    limit: Maximum number of tracks to return (default: 100)",
        "decorators": []
      },
      {
        "name": "find_all_tracks_with_soundcloud_urls",
        "lineno": 643,
        "end_lineno": 669,
        "args": [],
        "docstring": "Query the Music Tracks database for ALL items that have SoundCloud URLs.\nThis includes all tracks regardless of their processing status.",
        "decorators": []
      },
      {
        "name": "find_tracks_for_reprocessing",
        "lineno": 671,
        "end_lineno": 754,
        "args": [],
        "docstring": "Find tracks that need reprocessing (DL=False but have file paths, Eagle items, or fingerprints).",
        "decorators": []
      },
      {
        "name": "find_tracks_with_eagle_items_but_no_id",
        "lineno": 756,
        "end_lineno": 809,
        "args": [],
        "docstring": "Find tracks that have Eagle items (by file path) but no Eagle File ID in Notion.",
        "decorators": []
      },
      {
        "name": "find_tracks_with_playlist_relations",
        "lineno": 811,
        "end_lineno": 878,
        "args": [],
        "docstring": "Find tracks that have playlist relations and meet processing criteria:\n- SoundCloud URL is not empty\n- M4A File Path, WAV File Path, and AIFF File Path are all empty\n- Downloaded checkbox is unchecked\n- Playlist relation is not empty",
        "decorators": []
      },
      {
        "name": "extract_track_data",
        "lineno": 880,
        "end_lineno": 922,
        "args": [
          "page"
        ],
        "docstring": "Extract relevant data from a Notion page object.",
        "decorators": []
      },
      {
        "name": "get_text",
        "lineno": 884,
        "end_lineno": 890,
        "args": [
          "prop_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_url",
        "lineno": 892,
        "end_lineno": 896,
        "args": [
          "prop_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_number",
        "lineno": 898,
        "end_lineno": 902,
        "args": [
          "prop_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_select",
        "lineno": 904,
        "end_lineno": 908,
        "args": [
          "prop_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "upsert_track_page",
        "lineno": 924,
        "end_lineno": 1034,
        "args": [
          "meta",
          "eagle_item_id"
        ],
        "docstring": "Create or update a page in the TRACKS_DB_ID with metadata gathered\nduring processing. Uses sophisticated matching logic across multiple\nproperties to detect duplicates and merge them.",
        "decorators": []
      },
      {
        "name": "safe_update",
        "lineno": 975,
        "end_lineno": 1006,
        "args": [
          "page_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "parse_soundcloud_url",
        "lineno": 1039,
        "end_lineno": 1054,
        "args": [
          "url"
        ],
        "docstring": "Parse artist and track from SoundCloud URL.",
        "decorators": []
      },
      {
        "name": "detect_key",
        "lineno": 1056,
        "end_lineno": 1110,
        "args": [
          "wav_path"
        ],
        "docstring": "Very lightweight key estimation using librosa chroma profile correlation.\nReturns e.g. \"G Major\", \"A Minor\", or \"Unknown\".",
        "decorators": []
      },
      {
        "name": "convert_to_camelot",
        "lineno": 1112,
        "end_lineno": 1129,
        "args": [
          "key"
        ],
        "docstring": "Traditional key \u2192 Camelot code; unknown returns 'Unknown'.",
        "decorators": []
      },
      {
        "name": "get_playlist_names_from_track",
        "lineno": 1131,
        "end_lineno": 1170,
        "args": [
          "track_info"
        ],
        "docstring": "Get playlist names from a track's playlist relations.\n\nArgs:\n    track_info: Track information containing page_id\n    \nReturns:\n    List of playlist names",
        "decorators": []
      },
      {
        "name": "generate_comprehensive_tags",
        "lineno": 1172,
        "end_lineno": 1323,
        "args": [
          "track_info",
          "processing_data",
          "file_type"
        ],
        "docstring": "Generate comprehensive tags for files based on all available metadata.\n\nArgs:\n    track_info: Original track information from Notion\n    processing_data: Audio processing results (BPM, key, duration, etc.)\n    file_type: Type of file (AIFF, M4A, WAV)\n    \nReturns:\n    List of tags for the file",
        "decorators": []
      },
      {
        "name": "eagle_request",
        "lineno": 1333,
        "end_lineno": 1430,
        "args": [
          "method",
          "endpoint",
          "payload",
          "retry"
        ],
        "docstring": "Generic helper for calling Eagle's local REST API with automatic retries\nand transparent token handling.",
        "decorators": []
      },
      {
        "name": "eagle_switch_library",
        "lineno": 1432,
        "end_lineno": 1434,
        "args": [
          "library_path"
        ],
        "docstring": "Ensure Eagle is pointing at the correct library before we start.",
        "decorators": []
      },
      {
        "name": "eagle_get_or_create_folder",
        "lineno": 1436,
        "end_lineno": 1443,
        "args": [
          "folder_name"
        ],
        "docstring": "Return the Eagle folderId for folder_name, creating it if absent.",
        "decorators": []
      },
      {
        "name": "eagle_add_item",
        "lineno": 1445,
        "end_lineno": 1496,
        "args": [
          "path",
          "name",
          "website",
          "tags",
          "folder_id",
          "existing_eagle_id"
        ],
        "docstring": "Add a local file to Eagle and return the new item's ID (if available).",
        "decorators": []
      },
      {
        "name": "eagle_import_with_duplicate_management",
        "lineno": 1498,
        "end_lineno": 1570,
        "args": [
          "file_path",
          "title",
          "url",
          "tags",
          "folder_id",
          "expected_metadata"
        ],
        "docstring": "Comprehensive Eagle import with duplicate detection and management.\n\nThis function:\n1. Queries Eagle by filename to find all matching items\n2. Analyzes all matches to determine the best quality copy\n3. Checks if the best item meets metadata requirements\n4. Cleans up duplicates and reprocesses if needed\n5. Only creates new items when no matches are found\n\nReturns the Eagle item ID of the final item (new or existing).",
        "decorators": []
      },
      {
        "name": "eagle_move_to_trash",
        "lineno": 1572,
        "end_lineno": 1599,
        "args": [
          "item_ids"
        ],
        "docstring": "Move Eagle items to trash using the official API endpoint.\nThis is the only supported \"delete-like\" operation in Eagle.\n\nArgs:\n    item_ids: List of Eagle item IDs to move to trash\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "eagle_delete_item",
        "lineno": 1601,
        "end_lineno": 1610,
        "args": [
          "item_id"
        ],
        "docstring": "Legacy function - now redirects to moveToTrash.\nEagle only supports soft delete via moveToTrash, not hard delete.",
        "decorators": []
      },
      {
        "name": "eagle_find_items_by_path",
        "lineno": 1612,
        "end_lineno": 1623,
        "args": [
          "file_path"
        ],
        "docstring": "Find Eagle item IDs by file path. Returns list of item IDs.",
        "decorators": []
      },
      {
        "name": "eagle_find_items_by_filename",
        "lineno": 1625,
        "end_lineno": 1651,
        "args": [
          "filename"
        ],
        "docstring": "Find Eagle items by filename (without extension). Returns list of item dictionaries with full details.",
        "decorators": []
      },
      {
        "name": "eagle_analyze_item_quality",
        "lineno": 1653,
        "end_lineno": 1698,
        "args": [
          "item"
        ],
        "docstring": "Analyze the quality and metadata of an Eagle item. Returns quality assessment dict.",
        "decorators": []
      },
      {
        "name": "eagle_find_best_matching_item",
        "lineno": 1700,
        "end_lineno": 1730,
        "args": [
          "filename"
        ],
        "docstring": "Find the best matching Eagle item for a filename.\nReturns (best_item, all_matching_items) or (None, []) if no matches.",
        "decorators": []
      },
      {
        "name": "eagle_cleanup_duplicate_items",
        "lineno": 1732,
        "end_lineno": 1761,
        "args": [
          "items_to_keep",
          "all_matching_items"
        ],
        "docstring": "Clean up duplicate Eagle items, keeping only the best one.\nUses moveToTrash (soft delete) as Eagle only supports soft delete via API.\nReturns True if cleanup was successful.",
        "decorators": []
      },
      {
        "name": "eagle_needs_reprocessing",
        "lineno": 1763,
        "end_lineno": 1801,
        "args": [
          "item",
          "expected_metadata"
        ],
        "docstring": "Determine if an Eagle item needs reprocessing based on expected metadata.\nReturns True if reprocessing is needed.",
        "decorators": []
      },
      {
        "name": "reset_track_for_reprocessing",
        "lineno": 1803,
        "end_lineno": 1826,
        "args": [
          "page_id"
        ],
        "docstring": "Reset a track in Notion for reprocessing by clearing file paths, fingerprints, and Eagle IDs.",
        "decorators": []
      },
      {
        "name": "update_audio_processing_status",
        "lineno": 1829,
        "end_lineno": 1841,
        "args": [
          "page_id",
          "statuses"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "set_comprehensive_audio_processing_status",
        "lineno": 1843,
        "end_lineno": 1928,
        "args": [
          "page_id",
          "processing_data",
          "normalization_metrics"
        ],
        "docstring": "Set the comprehensive Audio Processing status based on what was ACTUALLY completed and verified.\nThis function dynamically determines which processing steps were completed for this specific item.\n\nArgs:\n    page_id: Notion page ID\n    processing_data: Audio processing results and status\n    normalization_metrics: Detailed normalization metrics if available\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "create_audio_processing_summary",
        "lineno": 1930,
        "end_lineno": 2259,
        "args": [
          "track_info",
          "processing_data",
          "file_paths",
          "eagle_item_id"
        ],
        "docstring": "Create a comprehensive audio processing summary with detailed audio quality metrics and format-specific analysis.\n\nArgs:\n    track_info: Original track information from Notion\n    processing_data: Audio processing results (BPM, key, duration, etc.)\n    file_paths: Generated file paths\n    eagle_item_id: Eagle item ID if available\n    \nReturns:\n    Formatted summary string with detailed audio processing metrics",
        "decorators": []
      },
      {
        "name": "check_for_music_embed",
        "lineno": 2261,
        "end_lineno": 2294,
        "args": [
          "page_id"
        ],
        "docstring": "Check if a music embed block (Spotify or SoundCloud) already exists on the Notion page.\n\nArgs:\n    page_id: Notion page ID\n    \nReturns:\n    True if music embed exists, False otherwise",
        "decorators": []
      },
      {
        "name": "add_music_embed_to_page",
        "lineno": 2296,
        "end_lineno": 2363,
        "args": [
          "page_id",
          "track_info"
        ],
        "docstring": "Add a music embed block (Spotify or SoundCloud) to the Notion page if it doesn't exist.\nPrioritizes Spotify if available, falls back to SoundCloud if no Spotify ID.\n\nArgs:\n    page_id: Notion page ID\n    track_info: Track information containing title, artist, spotify_id, and soundcloud_url\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "add_summary_to_notion_page",
        "lineno": 2365,
        "end_lineno": 2384,
        "args": [
          "page_id",
          "summary"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "cleanup_existing_summary_blocks",
        "lineno": 2386,
        "end_lineno": 2438,
        "args": [
          "page_id"
        ],
        "docstring": "Remove any existing audio processing summary blocks from the page to prevent duplicates.\n\nArgs:\n    page_id: Notion page ID\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "split_summary_into_large_sections",
        "lineno": 2440,
        "end_lineno": 2552,
        "args": [
          "summary"
        ],
        "docstring": "Split the summary into 4 large logical sections.\n\nArgs:\n    summary: Full summary text\n    \nReturns:\n    List of section dictionaries with title and content",
        "decorators": []
      },
      {
        "name": "update_audio_processing_properties",
        "lineno": 2554,
        "end_lineno": 2658,
        "args": [
          "page_id",
          "processing_data",
          "file_paths",
          "track_info"
        ],
        "docstring": "Update the new audio processing properties with detailed data.\n\nArgs:\n    page_id: Notion page ID\n    processing_data: Audio processing results\n    file_paths: Generated file paths\n    track_info: Original track information\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "find_track_by_title_and_artist",
        "lineno": 2660,
        "end_lineno": 2689,
        "args": [
          "title",
          "artist"
        ],
        "docstring": "Find a specific track in Notion by title and artist.",
        "decorators": []
      },
      {
        "name": "cleanup_files_for_reprocessing",
        "lineno": 2691,
        "end_lineno": 2725,
        "args": [
          "track_info"
        ],
        "docstring": "Delete physical files for reprocessing. Returns True if successful.",
        "decorators": []
      },
      {
        "name": "reprocess_track",
        "lineno": 2727,
        "end_lineno": 2767,
        "args": [
          "track_page"
        ],
        "docstring": "Reprocess a track by cleaning up and re-downloading.",
        "decorators": []
      },
      {
        "name": "auto_reprocess_tracks",
        "lineno": 2769,
        "end_lineno": 2790,
        "args": [],
        "docstring": "Automatically reprocess tracks that have DL=False but existing file paths.",
        "decorators": []
      },
      {
        "name": "batch_process_tracks",
        "lineno": 2792,
        "end_lineno": 2897,
        "args": [
          "filter_criteria",
          "max_tracks"
        ],
        "docstring": "Process all tracks that meet the specified filter criteria in a continuous batch run.\n\nArgs:\n    filter_criteria: Type of tracks to process\n        - \"unprocessed\": Tracks with DL=False and no file paths (default)\n        - \"reprocessing\": Tracks with DL=False but have file paths or Eagle items\n        - \"all\": All tracks with SoundCloud URLs regardless of status\n    max_tracks: Maximum number of tracks to process (None for all)",
        "decorators": []
      },
      {
        "name": "process_track",
        "lineno": 2899,
        "end_lineno": 2939,
        "args": [
          "track_page"
        ],
        "docstring": "Process a single track through the complete pipeline:\ndownload \u2192 convert \u2192 tag \u2192 Eagle import \u2192 Notion update\n\nArgs:\n    track_page: Notion page data for the track\n    \nReturns:\n    True if processing was successful, False otherwise",
        "decorators": []
      },
      {
        "name": "download_track",
        "lineno": 2944,
        "end_lineno": 3598,
        "args": [
          "url",
          "playlist_dir",
          "track_info",
          "playlist_name",
          "retry",
          "max_retries"
        ],
        "docstring": "Download, convert, tag, and move files.\nReturns dict for track entry or None on failure.",
        "decorators": []
      },
      {
        "name": "import_and_update",
        "lineno": 3405,
        "end_lineno": 3503,
        "args": [],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 3603,
        "end_lineno": 3733,
        "args": [],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "fix_eagle_file_id_property_type",
        "lineno": 3735,
        "end_lineno": 3783,
        "args": [],
        "docstring": "Fix the Eagle File ID property type from date to rich_text in the Notion database.",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "WorkspaceLogger",
        "lineno": 398,
        "end_lineno": 446,
        "docstring": "Unified logging system following workspace standards",
        "bases": []
      },
      {
        "name": "NotionManager",
        "lineno": 454,
        "end_lineno": 500,
        "docstring": "Notion API manager following workspace standards",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/soundcloud_download_prod_merge-2.py",
    "line_count": 8190,
    "imports": [
      "__future__",
      "argparse",
      "audio_normalizer",
      "audio_normalizer.notion_integration",
      "cProfile",
      "concurrent.futures",
      "datetime",
      "difflib",
      "dotenv",
      "eagle_api_smart",
      "glob",
      "googleapiclient.discovery",
      "hashlib",
      "importlib",
      "json",
      "librosa",
      "librosa.feature",
      "logging",
      "notion_client",
      "numpy",
      "os",
      "pathlib",
      "pyloudnorm",
      "random",
      "re",
      "requests",
      "scipy.io.wavfile",
      "send2trash",
      "shutil",
      "soundfile",
      "subprocess",
      "sys",
      "tempfile",
      "threading",
      "time",
      "traceback",
      "types",
      "typing",
      "unified_config",
      "unified_state_registry",
      "urllib.parse",
      "uuid",
      "yt_dlp"
    ],
    "functions": [
      {
        "name": "__init__",
        "lineno": 101,
        "end_lineno": 110,
        "args": [
          "self",
          "name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "debug",
        "lineno": 113,
        "end_lineno": 113,
        "args": [
          "self",
          "*a",
          "**k"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "info",
        "lineno": 114,
        "end_lineno": 114,
        "args": [
          "self",
          "*a",
          "**k"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "warning",
        "lineno": 115,
        "end_lineno": 115,
        "args": [
          "self",
          "*a",
          "**k"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "error",
        "lineno": 116,
        "end_lineno": 116,
        "args": [
          "self",
          "*a",
          "**k"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "logger",
        "lineno": 119,
        "end_lineno": 119,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": [
          "property"
        ]
      },
      {
        "name": "get_metrics",
        "lineno": 120,
        "end_lineno": 120,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "close",
        "lineno": 121,
        "end_lineno": 126,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "setup_logging",
        "lineno": 128,
        "end_lineno": 133,
        "args": [
          "session_id",
          "enable_notion",
          "log_level"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_env_or_default",
        "lineno": 160,
        "end_lineno": 164,
        "args": [
          "key"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "format_database_id",
        "lineno": 170,
        "end_lineno": 177,
        "args": [
          "db_id"
        ],
        "docstring": "Convert 32-char hex to UUID format for Notion API 2022-06-28+",
        "decorators": []
      },
      {
        "name": "_normalize_uuid",
        "lineno": 179,
        "end_lineno": 187,
        "args": [
          "s"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_truthy",
        "lineno": 190,
        "end_lineno": 196,
        "args": [
          "value"
        ],
        "docstring": "Lenient boolean conversion for configuration flags.",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 202,
        "end_lineno": 208,
        "args": [
          "self",
          "base_logger",
          "script_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__getattr__",
        "lineno": 210,
        "end_lineno": 211,
        "args": [
          "self",
          "item"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "logger",
        "lineno": 214,
        "end_lineno": 216,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": [
          "property"
        ]
      },
      {
        "name": "record_processed",
        "lineno": 218,
        "end_lineno": 219,
        "args": [
          "self",
          "increment"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "record_failed",
        "lineno": 221,
        "end_lineno": 222,
        "args": [
          "self",
          "increment"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "record_skipped",
        "lineno": 224,
        "end_lineno": 225,
        "args": [
          "self",
          "increment"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "temp_dir_created",
        "lineno": 227,
        "end_lineno": 228,
        "args": [
          "self",
          "temp_dir"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "temp_dir_cleaned",
        "lineno": 230,
        "end_lineno": 231,
        "args": [
          "self",
          "temp_dir"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "script_end",
        "lineno": 233,
        "end_lineno": 251,
        "args": [
          "self",
          "exit_code",
          "error_message"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "close",
        "lineno": 253,
        "end_lineno": 261,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_extract_priority_value",
        "lineno": 303,
        "end_lineno": 323,
        "args": [
          "props"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_priority_from_props",
        "lineno": 325,
        "end_lineno": 364,
        "args": [
          "props"
        ],
        "docstring": "Lower rank = higher priority. 5\u2192-5, 4\u2192-4, \u2026; name and order fallbacks.",
        "decorators": []
      },
      {
        "name": "_title_from_props",
        "lineno": 366,
        "end_lineno": 377,
        "args": [
          "props"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "order_candidates",
        "lineno": 379,
        "end_lineno": 390,
        "args": [
          "pages"
        ],
        "docstring": "Priority (numeric/name-aware) \u2192 Title A\u2013Z.",
        "decorators": []
      },
      {
        "name": "get_meter",
        "lineno": 495,
        "end_lineno": 501,
        "args": [
          "sample_rate"
        ],
        "docstring": "Return a cached pyloudnorm Meter for the given sample rate.",
        "decorators": []
      },
      {
        "name": "analyze_audio_loudness",
        "lineno": 506,
        "end_lineno": 562,
        "args": [
          "audio_samples",
          "sample_rate"
        ],
        "docstring": "FIXED: Proper LUFS loudness analysis using ITU-R BS.1770-4 standard via pyloudnorm.\nReplaces the broken RMS approximation with actual LUFS measurement.",
        "decorators": []
      },
      {
        "name": "analyze_audio_loudness_fallback",
        "lineno": 564,
        "end_lineno": 627,
        "args": [
          "audio_samples",
          "sample_rate"
        ],
        "docstring": "Improved fallback method when pyloudnorm is unavailable.\nStill better than the original RMS approximation.",
        "decorators": []
      },
      {
        "name": "detect_and_repair_clipping",
        "lineno": 629,
        "end_lineno": 671,
        "args": [
          "audio_samples",
          "threshold"
        ],
        "docstring": "Detect and repair clipped peaks using smoothing interpolation.\nBased on Platinum Notes clipping repair approach.",
        "decorators": []
      },
      {
        "name": "apply_warmth_saturation",
        "lineno": 673,
        "end_lineno": 709,
        "args": [
          "audio_samples",
          "mode"
        ],
        "docstring": "Apply harmonic saturation for warmth enhancement.\nBased on Platinum Notes warmth/saturation stage.",
        "decorators": []
      },
      {
        "name": "apply_loudness_normalization",
        "lineno": 711,
        "end_lineno": 782,
        "args": [
          "audio_samples",
          "target_lufs",
          "sample_rate",
          "max_true_peak_db"
        ],
        "docstring": "FIXED: Professional LUFS-based loudness normalization with proper limiting.\nUses pyloudnorm for accurate LUFS measurement and normalization.",
        "decorators": []
      },
      {
        "name": "apply_loudness_normalization_fallback",
        "lineno": 784,
        "end_lineno": 859,
        "args": [
          "audio_samples",
          "target_lufs",
          "sample_rate",
          "max_true_peak_db"
        ],
        "docstring": "Fallback normalization when pyloudnorm unavailable. Uses improved RMS-based approach.",
        "decorators": []
      },
      {
        "name": "normalize_audio_platinum_notes_style",
        "lineno": 861,
        "end_lineno": 950,
        "args": [
          "audio_samples",
          "sample_rate",
          "target_lufs",
          "warmth_mode"
        ],
        "docstring": "FIXED: Complete Platinum Notes-style audio normalization pipeline with proper LUFS measurement.\nThis replaces the original function with accurate LUFS processing.\n\nSteps:\n1. Analyze current audio characteristics with proper LUFS\n2. Detect and repair clipping\n3. Apply warmth/saturation\n4. Apply proper LUFS-based loudness normalization with limiting\n5. Final quality check\n\nReturns:\n    tuple: (normalized_audio_samples, processing_report)",
        "decorators": []
      },
      {
        "name": "notion_unarchive_if_needed",
        "lineno": 1003,
        "end_lineno": 1011,
        "args": [
          "page_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_notion_set_url_or_text",
        "lineno": 1013,
        "end_lineno": 1036,
        "args": [
          "props_dict",
          "prop_types",
          "key",
          "value",
          "log"
        ],
        "docstring": "Set a Notion property as url or rich_text depending on schema.",
        "decorators": []
      },
      {
        "name": "_filter_audio_processing_statuses",
        "lineno": 1056,
        "end_lineno": 1076,
        "args": [
          "values",
          "context"
        ],
        "docstring": "Return only allowed audio processing statuses, logging when unknown values are ignored.",
        "decorators": []
      },
      {
        "name": "update_audio_processing_status",
        "lineno": 1077,
        "end_lineno": 1112,
        "args": [
          "page_id",
          "statuses"
        ],
        "docstring": "Merge and persist Audio Processing multi-select values for the given Notion page.",
        "decorators": []
      },
      {
        "name": "_sc_slug_from_url",
        "lineno": 1113,
        "end_lineno": 1124,
        "args": [
          "url"
        ],
        "docstring": "Extract a stable keyword from a SoundCloud URL (artist/track slug).",
        "decorators": []
      },
      {
        "name": "_eagle_list",
        "lineno": 1126,
        "end_lineno": 1154,
        "args": [
          "keyword",
          "ext",
          "folders",
          "limit",
          "order_by"
        ],
        "docstring": "Thin wrapper around /api/item/list returning item dicts.",
        "decorators": []
      },
      {
        "name": "_eagle_find_existing",
        "lineno": 1156,
        "end_lineno": 1201,
        "args": [
          "name",
          "website",
          "tags",
          "folder_id",
          "ext"
        ],
        "docstring": "Lookup existing item ID. Order: seren:page tag \u2192 URL slug/URL \u2192 exact name+ext.",
        "decorators": []
      },
      {
        "name": "_sha1_short",
        "lineno": 1203,
        "end_lineno": 1207,
        "args": [
          "s"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_ext_from_path",
        "lineno": 1209,
        "end_lineno": 1213,
        "args": [
          "p"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_eagle_list_by_tag",
        "lineno": 1215,
        "end_lineno": 1235,
        "args": [
          "tag",
          "ext"
        ],
        "docstring": "Find most recently created item by tag (and optional extension). Returns item_id or None.\nUses /api/item/list with tags filter; fastest deterministic path when a sentinel tag exists.",
        "decorators": []
      },
      {
        "name": "_eagle_headers",
        "lineno": 1237,
        "end_lineno": 1246,
        "args": [
          "json_body"
        ],
        "docstring": "Centralized headers for Eagle API calls with optional token auth.",
        "decorators": []
      },
      {
        "name": "_clean_eagle_tags",
        "lineno": 1248,
        "end_lineno": 1259,
        "args": [
          "tags"
        ],
        "docstring": "Trim whitespace from tags and drop empty/non-string values.",
        "decorators": []
      },
      {
        "name": "eagle_add_from_path",
        "lineno": 1261,
        "end_lineno": 1284,
        "args": [
          "file_path",
          "name",
          "website",
          "tags",
          "folder_id",
          "timeout"
        ],
        "docstring": "Use Eagle's /api/item/addFromPath endpoint with the documented payload.",
        "decorators": []
      },
      {
        "name": "eagle_add_from_paths",
        "lineno": 1286,
        "end_lineno": 1319,
        "args": [
          "paths",
          "names",
          "websites",
          "tags_list",
          "folder_id",
          "timeout"
        ],
        "docstring": "Batch import files using Eagle's /api/item/addFromPaths payload.",
        "decorators": []
      },
      {
        "name": "eagle_force_tags",
        "lineno": 1321,
        "end_lineno": 1330,
        "args": [
          "item_id",
          "tags"
        ],
        "docstring": "Hard-set tags on an Eagle item via /api/item/update.",
        "decorators": []
      },
      {
        "name": "eagle_info",
        "lineno": 1332,
        "end_lineno": 1341,
        "args": [
          "item_id"
        ],
        "docstring": "Fetch Eagle item info (including tags) for validation or debugging.",
        "decorators": []
      },
      {
        "name": "eagle_find_recent_by_name",
        "lineno": 1343,
        "end_lineno": 1359,
        "args": [
          "name",
          "ext",
          "limit"
        ],
        "docstring": "Return the newest Eagle item ID that matches the provided name (and optional extension).",
        "decorators": []
      },
      {
        "name": "_eagle_set_url",
        "lineno": 1361,
        "end_lineno": 1370,
        "args": [
          "item_id",
          "website"
        ],
        "docstring": "Set the 'url' field on an Eagle item without touching tags.",
        "decorators": []
      },
      {
        "name": "_eagle_remove_tag",
        "lineno": 1372,
        "end_lineno": 1386,
        "args": [
          "item_id",
          "tag"
        ],
        "docstring": "Remove a specific tag from an Eagle item.",
        "decorators": []
      },
      {
        "name": "eagle_update_tags",
        "lineno": 1396,
        "end_lineno": 1447,
        "args": [
          "item_id",
          "tags"
        ],
        "docstring": "Merge-update tags on an existing Eagle item using the direct REST API.\nReads current tags, unions with incoming, then updates.\nReturns True on success, False otherwise.",
        "decorators": []
      },
      {
        "name": "complete_track_notion_update",
        "lineno": 1449,
        "end_lineno": 1540,
        "args": [
          "page_id",
          "track_info",
          "file_paths",
          "eagle_id"
        ],
        "docstring": "CRITICAL: Update Notion to mark track as complete and prevent reprocessing IMMEDIATELY after file processing.\n\nA track is excluded from future queries if:\n- DL checkbox = TRUE, OR\n- At least one file path is populated\n\nArgs:\n    page_id: Notion page ID\n    track_info: Track metadata dict containing 'title', 'artist', etc.\n    file_paths: Dict with keys 'm4a', 'aiff', 'wav' containing file paths\n    eagle_id: Optional Eagle file ID\n\nReturns:\n    True if update succeeded, False otherwise\n\nExample:\n    file_paths = {\n        'm4a': '/Volumes/VIBES/Playlists/Artist - Track.m4a',\n        'aiff': '/Volumes/VIBES/Djay-Pro-Auto-Import/Artist - Track.aiff'\n    }\n    \n    if not complete_track_notion_update(page_id, track_info, file_paths, eagle_id):\n        raise RuntimeError(\"Notion update failed - track will be reprocessed\")",
        "decorators": []
      },
      {
        "name": "_set_path",
        "lineno": 1491,
        "end_lineno": 1503,
        "args": [
          "property_label",
          "payload_key"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "verify_track_will_not_reprocess",
        "lineno": 1543,
        "end_lineno": 1599,
        "args": [
          "page_id"
        ],
        "docstring": "Verify that track won't be reprocessed by checking if it would pass query filters.\n\nReturns:\n    True if track is properly marked and won't reprocess\n    False if track will reappear in next query\n\nExample:\n    if not verify_track_will_not_reprocess(page_id):\n        raise RuntimeError(\"Track not properly marked - will be reprocessed\")",
        "decorators": []
      },
      {
        "name": "_is_eagle_api_available",
        "lineno": 1600,
        "end_lineno": 1613,
        "args": [
          "timeout"
        ],
        "docstring": "Require HTTP 200 and {'status':'success'} from /api/application/info.",
        "decorators": []
      },
      {
        "name": "_resolve_open_command",
        "lineno": 1616,
        "end_lineno": 1626,
        "args": [],
        "docstring": "Return the macOS open command for launching the Eagle app.",
        "decorators": []
      },
      {
        "name": "ensure_eagle_app_running",
        "lineno": 1629,
        "end_lineno": 1673,
        "args": [
          "force"
        ],
        "docstring": "Ensure the Eagle desktop app is running by issuing an open command if needed.\nReturns True when the API is reachable, False otherwise.",
        "decorators": []
      },
      {
        "name": "switch_to_configured_eagle_library",
        "lineno": 1675,
        "end_lineno": 1731,
        "args": [],
        "docstring": "Ensure Eagle switches to the configured library. Use smart API if available, then REST fallback, then verify.",
        "decorators": []
      },
      {
        "name": "_eagle_import_file_direct",
        "lineno": 1733,
        "end_lineno": 1819,
        "args": [
          "path",
          "name",
          "website",
          "tags",
          "folder_id",
          "existing_eagle_id"
        ],
        "docstring": "Import a file into Eagle via /api/item/addFromPath and deterministically recover its ID.\n- If existing_eagle_id is provided, perform a non-destructive tag merge and return it.\n- On fresh import, append a per-file sentinel tag so we can list-and-find the ID reliably.\n- After import, force-set tags and set the source URL via /api/item/update.",
        "decorators": []
      },
      {
        "name": "eagle_add_item_adapter",
        "lineno": 1821,
        "end_lineno": 1829,
        "args": [
          "path",
          "name",
          "website",
          "tags",
          "folder_id",
          "existing_eagle_id"
        ],
        "docstring": "Bypass smart API and use direct REST import reliably.",
        "decorators": []
      },
      {
        "name": "ensure_writable_dir",
        "lineno": 1858,
        "end_lineno": 1908,
        "args": [
          "p",
          "name"
        ],
        "docstring": "Preflight check for user-configured directories.\n\n- If the path is under /Volumes/<VolumeName>/... and the base volume is not mounted,\n  emit a clear error and exit instead of trying to create /Volumes/<VolumeName> (which\n  requires root).\n- If the directory exists but is not writable, emit a clear error and exit.\n- Otherwise, create the directory tree if missing.",
        "decorators": []
      },
      {
        "name": "_resolve_workspace_path",
        "lineno": 1918,
        "end_lineno": 1929,
        "args": [
          "config_key",
          "env_key",
          "default_relative"
        ],
        "docstring": "Resolve workspace directories from unified config or environment, falling back to a repo-local path.",
        "decorators": []
      },
      {
        "name": "_resolve_ffmpeg_path",
        "lineno": 1964,
        "end_lineno": 1982,
        "args": [],
        "docstring": "Resolve the ffmpeg binary path with fallbacks that prefer config/env over hard-coded locations.",
        "decorators": []
      },
      {
        "name": "_sanitize_filename_component",
        "lineno": 2009,
        "end_lineno": 2013,
        "args": [
          "name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "find_existing_outputs",
        "lineno": 2015,
        "end_lineno": 2049,
        "args": [
          "sc_url",
          "out_dir"
        ],
        "docstring": "Probe OUT_DIR for already-rendered outputs derived from the track title.\nReturns {'aiff','m4a','wav'} -> absolute paths or None.",
        "decorators": []
      },
      {
        "name": "pre_download_repair_if_outputs_exist",
        "lineno": 2051,
        "end_lineno": 2066,
        "args": [
          "page_id",
          "sc_url"
        ],
        "docstring": "If outputs exist already, skip download and fix Notion so the item will not reprocess.\nReturns True if handled.",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 2074,
        "end_lineno": 2080,
        "args": [
          "self",
          "token"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_req",
        "lineno": 2082,
        "end_lineno": 2102,
        "args": [
          "self",
          "method",
          "path",
          "body",
          "retry"
        ],
        "docstring": "Make API request with retry logic following workspace standards",
        "decorators": []
      },
      {
        "name": "query_database",
        "lineno": 2104,
        "end_lineno": 2120,
        "args": [
          "self",
          "database_id",
          "query"
        ],
        "docstring": "Query database with workspace-standard error handling",
        "decorators": []
      },
      {
        "name": "update_page",
        "lineno": 2122,
        "end_lineno": 2138,
        "args": [
          "self",
          "page_id",
          "properties"
        ],
        "docstring": "Update page with workspace-standard error handling",
        "decorators": []
      },
      {
        "name": "filter",
        "lineno": 2141,
        "end_lineno": 2146,
        "args": [
          "self",
          "record"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "update_track_with_registry",
        "lineno": 2170,
        "end_lineno": 2219,
        "args": [
          "page_id",
          "properties",
          "track_data"
        ],
        "docstring": "Update track in Notion and registry (Phase 1 integration).\nNon-breaking: falls back to Notion-only if registry unavailable.",
        "decorators": []
      },
      {
        "name": "_normalize_url",
        "lineno": 2224,
        "end_lineno": 2234,
        "args": [
          "u"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_clean_title",
        "lineno": 2237,
        "end_lineno": 2244,
        "args": [
          "t"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_page_text_for",
        "lineno": 2246,
        "end_lineno": 2259,
        "args": [
          "prop_obj"
        ],
        "docstring": "Extract text from a page property payload; uses existing helper where possible.",
        "decorators": []
      },
      {
        "name": "_score_page_for_keeper",
        "lineno": 2261,
        "end_lineno": 2289,
        "args": [
          "page"
        ],
        "docstring": "Higher is better. Use presence of files, Eagle ID, fingerprint, then edit time.",
        "decorators": []
      },
      {
        "name": "has_path",
        "lineno": 2266,
        "end_lineno": 2268,
        "args": [
          "name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_union_unique",
        "lineno": 2291,
        "end_lineno": 2296,
        "args": [
          "seq"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_merge_values",
        "lineno": 2298,
        "end_lineno": 2356,
        "args": [
          "prop_type",
          "keeper_val",
          "donor_val"
        ],
        "docstring": "Return merged Notion property payload fragment for a single property type.",
        "decorators": []
      },
      {
        "name": "_build_update_payload",
        "lineno": 2358,
        "end_lineno": 2432,
        "args": [
          "merged",
          "prop_types"
        ],
        "docstring": "Convert merged page property values into a payload acceptable for notion.pages.update.",
        "decorators": []
      },
      {
        "name": "_limit_multi_select_entries",
        "lineno": 2455,
        "end_lineno": 2475,
        "args": [
          "value",
          "ensure",
          "limit"
        ],
        "docstring": "Clamp multi_select payloads to avoid exploding schema options.",
        "decorators": []
      },
      {
        "name": "_build_trimmed_update_payload",
        "lineno": 2477,
        "end_lineno": 2510,
        "args": [
          "update_payload",
          "prop_types"
        ],
        "docstring": "Reduce an update payload to only safe property types for fallback updates when Notion\nreports the schema size limit has been reached.",
        "decorators": []
      },
      {
        "name": "_merge_group_into_keeper",
        "lineno": 2512,
        "end_lineno": 2591,
        "args": [
          "keeper",
          "donors",
          "dry_run"
        ],
        "docstring": "Merge donors into keeper, update keeper, archive donors. Return keeper id.",
        "decorators": []
      },
      {
        "name": "_fetch_by_equals",
        "lineno": 2593,
        "end_lineno": 2611,
        "args": [
          "prop_name",
          "value"
        ],
        "docstring": "Query helper for exact equality on url or rich_text supported by our dynamic types.",
        "decorators": []
      },
      {
        "name": "_fetch_recent",
        "lineno": 2616,
        "end_lineno": 2626,
        "args": [
          "limit"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "dedupe_for_meta",
        "lineno": 2628,
        "end_lineno": 2673,
        "args": [
          "meta",
          "dry_run"
        ],
        "docstring": "Find and merge duplicates based on SC URL, Spotify ID, and cleaned Title. Return keeper id or None.",
        "decorators": []
      },
      {
        "name": "try_merge_duplicates_for_page",
        "lineno": 2679,
        "end_lineno": 2709,
        "args": [
          "page",
          "dry_run"
        ],
        "docstring": "Given a Notion page selected by the existing filters, look for duplicates\nusing the same criteria as dedupe_for_meta(). If a different keeper is chosen,\nreturn that keeper's page object; otherwise return the original page.\nDoes not modify the original DB query filters.",
        "decorators": []
      },
      {
        "name": "_get_tracks_db_prop_types",
        "lineno": 2723,
        "end_lineno": 2740,
        "args": [],
        "docstring": "Return a mapping of property name -> Notion property type for the Tracks DB.\nTypes are the Notion canonical types (e.g., 'url', 'rich_text', 'checkbox', 'date', 'title', etc.).",
        "decorators": []
      },
      {
        "name": "_resolve_prop_name",
        "lineno": 2742,
        "end_lineno": 2750,
        "args": [
          "preferred"
        ],
        "docstring": "Return the first existing property name for the given semantic key using ALT_PROP_NAMES.\nIf none found, return None.",
        "decorators": []
      },
      {
        "name": "_filter_is_empty",
        "lineno": 2752,
        "end_lineno": 2769,
        "args": [
          "prop_key"
        ],
        "docstring": "Build a Notion filter for 'is_empty' depending on the property's actual type.\nReturns None if the property does not exist or type unsupported for this filter.",
        "decorators": []
      },
      {
        "name": "_filter_is_not_empty",
        "lineno": 2771,
        "end_lineno": 2783,
        "args": [
          "prop_key"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "query_soundcloud_playlist",
        "lineno": 2788,
        "end_lineno": 2874,
        "args": [
          "playlist_name"
        ],
        "docstring": "Query SoundCloud for a playlist by exact (case-sensitive) name or direct URL.\n\nArgs:\n    playlist_name: Playlist name or full SoundCloud playlist URL\n\nReturns:\n    List of track metadata dictionaries suitable for Notion ingestion",
        "decorators": []
      },
      {
        "name": "_build_url_filter",
        "lineno": 2877,
        "end_lineno": 2893,
        "args": [
          "property_name",
          "url_value"
        ],
        "docstring": "Construct a Notion filter for URL/rich_text/title properties.",
        "decorators": []
      },
      {
        "name": "check_track_exists_in_database",
        "lineno": 2896,
        "end_lineno": 2931,
        "args": [
          "track_url"
        ],
        "docstring": "Check if a track already exists in the Notion database by SoundCloud URL.\n\nArgs:\n    track_url: SoundCloud track URL\n\nReturns:\n    Page ID if track exists, None otherwise",
        "decorators": []
      },
      {
        "name": "add_new_track_to_database",
        "lineno": 2934,
        "end_lineno": 3013,
        "args": [
          "track_data"
        ],
        "docstring": "Add a new track to the Notion database with metadata.\n\nArgs:\n    track_data: Track metadata from YT-DLP\n\nReturns:\n    Notion page ID of created track",
        "decorators": []
      },
      {
        "name": "_filter_checkbox_equals",
        "lineno": 3015,
        "end_lineno": 3021,
        "args": [
          "prop_key",
          "value"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_prop_text_value",
        "lineno": 3023,
        "end_lineno": 3058,
        "args": [
          "prop"
        ],
        "docstring": "Extract textual content from a Notion property payload.",
        "decorators": []
      },
      {
        "name": "should_reprocess_page",
        "lineno": 3060,
        "end_lineno": 3112,
        "args": [
          "page"
        ],
        "docstring": "Determine whether a track should be reprocessed based on current Notion properties.",
        "decorators": []
      },
      {
        "name": "_get_prop",
        "lineno": 3065,
        "end_lineno": 3067,
        "args": [
          "key"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_get_tracks_db_props",
        "lineno": 3117,
        "end_lineno": 3128,
        "args": [],
        "docstring": "Fetch and cache the property names in the Tracks database.",
        "decorators": []
      },
      {
        "name": "find_next_track",
        "lineno": 3130,
        "end_lineno": 3225,
        "args": [],
        "docstring": "Query the Music Tracks database for the newest item that meets criteria,\nbuilding filters dynamically based on available properties and types.",
        "decorators": []
      },
      {
        "name": "_build_unprocessed_tracks_query",
        "lineno": 3227,
        "end_lineno": 3263,
        "args": [
          "limit"
        ],
        "docstring": "Construct the Notion query payload for fetching unprocessed tracks.",
        "decorators": []
      },
      {
        "name": "find_all_tracks_for_processing",
        "lineno": 3266,
        "end_lineno": 3287,
        "args": [
          "limit"
        ],
        "docstring": "Query for ALL items that meet criteria (dynamic property checks).",
        "decorators": []
      },
      {
        "name": "run_all_mode",
        "lineno": 3289,
        "end_lineno": 3352,
        "args": [
          "limit"
        ],
        "docstring": "Process all filter-passing items from the Music Tracks database.\nReturns the number of items successfully processed.",
        "decorators": []
      },
      {
        "name": "find_tracks_for_processing_batch",
        "lineno": 3354,
        "end_lineno": 3398,
        "args": [
          "batch_size"
        ],
        "docstring": "Small batch query with dynamic property handling.",
        "decorators": []
      },
      {
        "name": "_extract_track_meta_for_dedupe",
        "lineno": 3404,
        "end_lineno": 3415,
        "args": [
          "page"
        ],
        "docstring": "Extract normalized metadata for duplicate detection.",
        "decorators": []
      },
      {
        "name": "_get",
        "lineno": 3407,
        "end_lineno": 3409,
        "args": [
          "key"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_group_batch_duplicates",
        "lineno": 3417,
        "end_lineno": 3461,
        "args": [
          "pages"
        ],
        "docstring": "Group pages that are duplicates within the batch by SC URL, Spotify ID, or cleaned title.",
        "decorators": []
      },
      {
        "name": "find",
        "lineno": 3424,
        "end_lineno": 3428,
        "args": [
          "x"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "union",
        "lineno": 3429,
        "end_lineno": 3432,
        "args": [
          "a",
          "b"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "process_track_page_wrapper",
        "lineno": 3463,
        "end_lineno": 3491,
        "args": [
          "page"
        ],
        "docstring": "Wrapper function for parallel track processing.\nReturns (track_id, error) tuple for concurrent execution.",
        "decorators": []
      },
      {
        "name": "process_pages_parallel",
        "lineno": 3493,
        "end_lineno": 3525,
        "args": [
          "pages",
          "max_workers"
        ],
        "docstring": "Process multiple pages in parallel using ThreadPoolExecutor.\nReturns the number of successfully processed pages.",
        "decorators": []
      },
      {
        "name": "dedupe_within_batch",
        "lineno": 3527,
        "end_lineno": 3550,
        "args": [
          "pages",
          "dry_run"
        ],
        "docstring": "Merge duplicates inside this batch immediately. Return keeper pages.",
        "decorators": []
      },
      {
        "name": "process_batch_immediately",
        "lineno": 3552,
        "end_lineno": 3591,
        "args": [
          "batch_size",
          "dry_run"
        ],
        "docstring": "Fetch first batch, merge duplicates in-batch immediately, then process eligible items.",
        "decorators": []
      },
      {
        "name": "find_all_tracks_with_soundcloud_urls",
        "lineno": 3593,
        "end_lineno": 3618,
        "args": [],
        "docstring": "Query the Music Tracks database for ALL items that have SoundCloud URLs.\nThis includes all tracks regardless of their processing status.",
        "decorators": []
      },
      {
        "name": "find_tracks_for_reprocessing",
        "lineno": 3620,
        "end_lineno": 3686,
        "args": [],
        "docstring": "Find tracks that need reprocessing (DL=False but have file paths, Eagle items, or fingerprints).",
        "decorators": []
      },
      {
        "name": "find_tracks_with_eagle_items_but_no_id",
        "lineno": 3688,
        "end_lineno": 3745,
        "args": [],
        "docstring": "Find tracks that have Eagle items (by file path) but no Eagle File ID in Notion.",
        "decorators": []
      },
      {
        "name": "find_tracks_with_playlist_relations",
        "lineno": 3747,
        "end_lineno": 3778,
        "args": [],
        "docstring": "Find tracks with playlist relations using dynamic property filters.",
        "decorators": []
      },
      {
        "name": "extract_track_data",
        "lineno": 3780,
        "end_lineno": 3833,
        "args": [
          "page"
        ],
        "docstring": "Extract relevant data from a Notion page object.",
        "decorators": []
      },
      {
        "name": "get_text",
        "lineno": 3784,
        "end_lineno": 3790,
        "args": [
          "prop_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_url",
        "lineno": 3792,
        "end_lineno": 3796,
        "args": [
          "prop_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_number",
        "lineno": 3798,
        "end_lineno": 3802,
        "args": [
          "prop_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_select",
        "lineno": 3804,
        "end_lineno": 3808,
        "args": [
          "prop_name"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_priority",
        "lineno": 3810,
        "end_lineno": 3813,
        "args": [],
        "docstring": "Extract priority from page properties",
        "decorators": []
      },
      {
        "name": "get_priority_rank",
        "lineno": 3815,
        "end_lineno": 3817,
        "args": [],
        "docstring": "Get priority rank for sorting display",
        "decorators": []
      },
      {
        "name": "upsert_track_page",
        "lineno": 3835,
        "end_lineno": 4000,
        "args": [
          "meta",
          "eagle_item_id"
        ],
        "docstring": "Create or update a page in the TRACKS_DB_ID with metadata gathered\nduring processing. Uses sophisticated matching logic across multiple\nproperties to detect duplicates and merge them.",
        "decorators": []
      },
      {
        "name": "set_rich_or_title",
        "lineno": 3860,
        "end_lineno": 3868,
        "args": [
          "props_dict",
          "key",
          "value"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "set_select",
        "lineno": 3870,
        "end_lineno": 3875,
        "args": [
          "props_dict",
          "key",
          "value"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "set_number",
        "lineno": 3877,
        "end_lineno": 3880,
        "args": [
          "props_dict",
          "key",
          "value"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "set_checkbox",
        "lineno": 3882,
        "end_lineno": 3885,
        "args": [
          "props_dict",
          "key",
          "value"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "set_multi_select",
        "lineno": 3887,
        "end_lineno": 3892,
        "args": [
          "props_dict",
          "key",
          "values"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "set_date",
        "lineno": 3894,
        "end_lineno": 3897,
        "args": [
          "props_dict",
          "key",
          "iso_value"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "parse_soundcloud_url",
        "lineno": 4005,
        "end_lineno": 4020,
        "args": [
          "url"
        ],
        "docstring": "Parse artist and track from SoundCloud URL.",
        "decorators": []
      },
      {
        "name": "detect_key",
        "lineno": 4022,
        "end_lineno": 4076,
        "args": [
          "wav_path"
        ],
        "docstring": "Very lightweight key estimation using librosa chroma profile correlation.\nReturns e.g. \"G Major\", \"A Minor\", or \"Unknown\".",
        "decorators": []
      },
      {
        "name": "convert_to_camelot",
        "lineno": 4078,
        "end_lineno": 4095,
        "args": [
          "key"
        ],
        "docstring": "Traditional key \u2192 Camelot code; unknown returns 'Unknown'.",
        "decorators": []
      },
      {
        "name": "get_playlist_names_from_track",
        "lineno": 4097,
        "end_lineno": 4136,
        "args": [
          "track_info"
        ],
        "docstring": "Get playlist names from a track's playlist relations.\n\nArgs:\n    track_info: Track information containing page_id\n    \nReturns:\n    List of playlist names",
        "decorators": []
      },
      {
        "name": "compute_file_fingerprint",
        "lineno": 4138,
        "end_lineno": 4144,
        "args": [
          "file_path",
          "chunk_size"
        ],
        "docstring": "Compute a stable SHA-256 fingerprint for the provided audio file.",
        "decorators": []
      },
      {
        "name": "estimate_tempo_from_onset",
        "lineno": 4146,
        "end_lineno": 4150,
        "args": [
          "onset_env",
          "sr"
        ],
        "docstring": "Estimate tempo using the modern librosa API with fallback for older versions.",
        "decorators": []
      },
      {
        "name": "generate_comprehensive_tags",
        "lineno": 4152,
        "end_lineno": 4308,
        "args": [
          "track_info",
          "processing_data",
          "file_type"
        ],
        "docstring": "Generate comprehensive tags for files based on all available metadata.\n\nArgs:\n    track_info: Original track information from Notion\n    processing_data: Audio processing results (BPM, key, duration, etc.)\n    file_type: Type of file (AIFF, M4A, WAV)\n    \nReturns:\n    List of tags for the file",
        "decorators": []
      },
      {
        "name": "eagle_request",
        "lineno": 4318,
        "end_lineno": 4419,
        "args": [
          "method",
          "endpoint",
          "payload",
          "retry"
        ],
        "docstring": "Generic helper for calling Eagle's local REST API with automatic retries\nand transparent token handling.",
        "decorators": []
      },
      {
        "name": "eagle_switch_library",
        "lineno": 4421,
        "end_lineno": 4437,
        "args": [
          "library_path"
        ],
        "docstring": "Ensure Eagle is pointing at the correct library before we start.",
        "decorators": []
      },
      {
        "name": "eagle_get_or_create_folder",
        "lineno": 4439,
        "end_lineno": 4446,
        "args": [
          "folder_name"
        ],
        "docstring": "Return the Eagle folderId for folder_name, creating it if absent.",
        "decorators": []
      },
      {
        "name": "eagle_import_with_duplicate_management",
        "lineno": 4448,
        "end_lineno": 4527,
        "args": [
          "file_path",
          "title",
          "url",
          "tags",
          "folder_id",
          "expected_metadata",
          "audio_fingerprint"
        ],
        "docstring": "Comprehensive Eagle import with duplicate detection and management.\n\nThis function:\n1. Queries Eagle by filename to find all matching items\n2. Analyzes all matches to determine the best quality copy\n3. Checks if the best item meets metadata requirements\n4. Cleans up duplicates and reprocesses if needed\n5. Only creates new items when no matches are found\n\nReturns the Eagle item ID of the final item (new or existing).",
        "decorators": []
      },
      {
        "name": "eagle_move_to_trash",
        "lineno": 4529,
        "end_lineno": 4556,
        "args": [
          "item_ids"
        ],
        "docstring": "Move Eagle items to trash using the official API endpoint.\nThis is the only supported \"delete-like\" operation in Eagle.\n\nArgs:\n    item_ids: List of Eagle item IDs to move to trash\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "eagle_delete_item",
        "lineno": 4558,
        "end_lineno": 4567,
        "args": [
          "item_id"
        ],
        "docstring": "Legacy function - now redirects to moveToTrash.\nEagle only supports soft delete via moveToTrash, not hard delete.",
        "decorators": []
      },
      {
        "name": "eagle_find_items_by_path",
        "lineno": 4569,
        "end_lineno": 4580,
        "args": [
          "file_path"
        ],
        "docstring": "Find Eagle item IDs by file path. Returns list of item IDs.",
        "decorators": []
      },
      {
        "name": "eagle_fetch_all_items",
        "lineno": 4582,
        "end_lineno": 4589,
        "args": [],
        "docstring": "Fetch the full item list from Eagle, handling errors gracefully.",
        "decorators": []
      },
      {
        "name": "eagle_find_items_by_filename",
        "lineno": 4591,
        "end_lineno": 4616,
        "args": [
          "filename",
          "items"
        ],
        "docstring": "Find Eagle items by filename (without extension). Returns list of item dictionaries with full details.",
        "decorators": []
      },
      {
        "name": "_sanitize_match_string",
        "lineno": 4618,
        "end_lineno": 4623,
        "args": [
          "*parts"
        ],
        "docstring": "Lowercase, alphanumeric-only representation used for fuzzy matching.",
        "decorators": []
      },
      {
        "name": "eagle_find_best_matching_item",
        "lineno": 4625,
        "end_lineno": 4689,
        "args": [
          "filename",
          "fingerprint",
          "title",
          "artist"
        ],
        "docstring": "Find the best matching Eagle item using fingerprint first, then fuzzy matching,\nand finally filename matching as a fallback.\nReturns (best_item, all_matching_items) or (None, []) if no matches.",
        "decorators": []
      },
      {
        "name": "eagle_analyze_item_quality",
        "lineno": 4691,
        "end_lineno": 4736,
        "args": [
          "item"
        ],
        "docstring": "Analyze the quality and metadata of an Eagle item. Returns quality assessment dict.",
        "decorators": []
      },
      {
        "name": "eagle_cleanup_duplicate_items",
        "lineno": 4738,
        "end_lineno": 4767,
        "args": [
          "items_to_keep",
          "all_matching_items"
        ],
        "docstring": "Clean up duplicate Eagle items, keeping only the best one.\nUses moveToTrash (soft delete) as Eagle only supports soft delete via API.\nReturns True if cleanup was successful.",
        "decorators": []
      },
      {
        "name": "eagle_needs_reprocessing",
        "lineno": 4769,
        "end_lineno": 4813,
        "args": [
          "item",
          "expected_metadata"
        ],
        "docstring": "Determine if an Eagle item needs reprocessing based on expected metadata.\nReturns True if reprocessing is needed.",
        "decorators": []
      },
      {
        "name": "reset_track_for_reprocessing",
        "lineno": 4815,
        "end_lineno": 4870,
        "args": [
          "page_id"
        ],
        "docstring": "Reset a track in Notion for reprocessing by clearing file paths, fingerprints, and Eagle IDs.",
        "decorators": []
      },
      {
        "name": "set_comprehensive_audio_processing_status",
        "lineno": 4873,
        "end_lineno": 4954,
        "args": [
          "page_id",
          "processing_data",
          "normalization_metrics"
        ],
        "docstring": "Set the comprehensive Audio Processing status based on what was ACTUALLY completed and verified.\nThis function dynamically determines which processing steps were completed for this specific item.",
        "decorators": []
      },
      {
        "name": "create_audio_processing_summary",
        "lineno": 4955,
        "end_lineno": 5284,
        "args": [
          "track_info",
          "processing_data",
          "file_paths",
          "eagle_item_id"
        ],
        "docstring": "Create a comprehensive audio processing summary with detailed audio quality metrics and format-specific analysis.\n\nArgs:\n    track_info: Original track information from Notion\n    processing_data: Audio processing results (BPM, key, duration, etc.)\n    file_paths: Generated file paths\n    eagle_item_id: Eagle item ID if available\n    \nReturns:\n    Formatted summary string with detailed audio processing metrics",
        "decorators": []
      },
      {
        "name": "check_for_music_embed",
        "lineno": 5286,
        "end_lineno": 5319,
        "args": [
          "page_id"
        ],
        "docstring": "Check if a music embed block (Spotify or SoundCloud) already exists on the Notion page.\n\nArgs:\n    page_id: Notion page ID\n    \nReturns:\n    True if music embed exists, False otherwise",
        "decorators": []
      },
      {
        "name": "add_music_embed_to_page",
        "lineno": 5321,
        "end_lineno": 5388,
        "args": [
          "page_id",
          "track_info"
        ],
        "docstring": "Add a music embed block (Spotify or SoundCloud) to the Notion page if it doesn't exist.\nPrioritizes Spotify if available, falls back to SoundCloud if no Spotify ID.\n\nArgs:\n    page_id: Notion page ID\n    track_info: Track information containing title, artist, spotify_id, and soundcloud_url\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "add_summary_to_notion_page",
        "lineno": 5390,
        "end_lineno": 5409,
        "args": [
          "page_id",
          "summary"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "cleanup_existing_summary_blocks",
        "lineno": 5411,
        "end_lineno": 5463,
        "args": [
          "page_id"
        ],
        "docstring": "Remove any existing audio processing summary blocks from the page to prevent duplicates.\n\nArgs:\n    page_id: Notion page ID\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "split_summary_into_large_sections",
        "lineno": 5465,
        "end_lineno": 5577,
        "args": [
          "summary"
        ],
        "docstring": "Split the summary into 4 large logical sections.\n\nArgs:\n    summary: Full summary text\n    \nReturns:\n    List of section dictionaries with title and content",
        "decorators": []
      },
      {
        "name": "update_audio_processing_properties",
        "lineno": 5579,
        "end_lineno": 5700,
        "args": [
          "page_id",
          "processing_data",
          "file_paths",
          "track_info"
        ],
        "docstring": "Update the new audio processing properties with detailed data.\n\nArgs:\n    page_id: Notion page ID\n    processing_data: Audio processing results\n    file_paths: Generated file paths\n    track_info: Original track information\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "find_track_by_title_and_artist",
        "lineno": 5702,
        "end_lineno": 5731,
        "args": [
          "title",
          "artist"
        ],
        "docstring": "Find a specific track in Notion by title and artist.",
        "decorators": []
      },
      {
        "name": "cleanup_files_for_reprocessing",
        "lineno": 5733,
        "end_lineno": 5767,
        "args": [
          "track_info"
        ],
        "docstring": "Delete physical files for reprocessing. Returns True if successful.",
        "decorators": []
      },
      {
        "name": "reprocess_track",
        "lineno": 5769,
        "end_lineno": 5822,
        "args": [
          "track_page"
        ],
        "docstring": "Reprocess a track by cleaning up and re-downloading.",
        "decorators": []
      },
      {
        "name": "auto_reprocess_tracks",
        "lineno": 5824,
        "end_lineno": 5852,
        "args": [],
        "docstring": "Automatically reprocess tracks that have DL=False but existing file paths.",
        "decorators": []
      },
      {
        "name": "process_tracks_in_batches",
        "lineno": 5857,
        "end_lineno": 6032,
        "args": [
          "filter_criteria",
          "max_tracks",
          "batch_size",
          "strategy",
          "max_empty_batches"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "batch_process_tracks",
        "lineno": 6034,
        "end_lineno": 6040,
        "args": [
          "filter_criteria",
          "max_tracks"
        ],
        "docstring": "Process tracks in classic full-batch mode.",
        "decorators": []
      },
      {
        "name": "efficient_batch_process_tracks",
        "lineno": 6043,
        "end_lineno": 6054,
        "args": [
          "filter_criteria",
          "max_tracks",
          "batch_size"
        ],
        "docstring": "Process tracks in incremental batches to reduce Notion query size.",
        "decorators": []
      },
      {
        "name": "check_eagle_for_existing_file",
        "lineno": 6056,
        "end_lineno": 6118,
        "args": [
          "track_data"
        ],
        "docstring": "Check if a file already exists in the Eagle library based on track metadata.\n\nArgs:\n    track_data: Track metadata dictionary\n    \nReturns:\n    Eagle item dictionary if found, None otherwise",
        "decorators": []
      },
      {
        "name": "process_track",
        "lineno": 6120,
        "end_lineno": 6173,
        "args": [
          "track_page"
        ],
        "docstring": "Process a single track through the complete pipeline:\ndownload \u2192 convert \u2192 tag \u2192 Eagle import \u2192 Notion update\n\nArgs:\n    track_page: Notion page data for the track\n    \nReturns:\n    True if processing was successful, False otherwise",
        "decorators": []
      },
      {
        "name": "is_geo_restricted",
        "lineno": 6189,
        "end_lineno": 6214,
        "args": [
          "error"
        ],
        "docstring": "Detect geo-restriction from yt-dlp error messages.\n\nArgs:\n    error: Exception from yt-dlp download attempt\n    \nReturns:\n    True if error indicates geo-restriction, False otherwise",
        "decorators": []
      },
      {
        "name": "try_youtube_download",
        "lineno": 6217,
        "end_lineno": 6323,
        "args": [
          "url",
          "track_info",
          "playlist_dir",
          "playlist_name",
          "retry",
          "max_retries"
        ],
        "docstring": "Download track from YouTube as fallback source.\n\nArgs:\n    url: YouTube URL to download from\n    track_info: Track metadata dictionary\n    playlist_dir: Directory to save file\n    playlist_name: Name of playlist\n    retry: Current retry attempt\n    max_retries: Maximum retry attempts\n    \nReturns:\n    Dictionary with download results or None on failure",
        "decorators": []
      },
      {
        "name": "search_youtube_for_track",
        "lineno": 6326,
        "end_lineno": 6403,
        "args": [
          "artist",
          "title"
        ],
        "docstring": "Search YouTube for a track by artist and title.\nReturns the first matching video URL.\n\nArgs:\n    artist: Artist name\n    title: Track title\n    \nReturns:\n    YouTube URL if found, None otherwise\n    \nNote:\n    Requires YOUTUBE_API_KEY environment variable for Google API.\n    If not available, attempts yt-dlp search as fallback.",
        "decorators": []
      },
      {
        "name": "get_youtube_url_from_notion",
        "lineno": 6406,
        "end_lineno": 6423,
        "args": [
          "track_info"
        ],
        "docstring": "Extract YouTube URL from Notion track info.\n\nArgs:\n    track_info: Track metadata dictionary from Notion\n    \nReturns:\n    YouTube URL if present, None otherwise",
        "decorators": []
      },
      {
        "name": "update_notion_download_source",
        "lineno": 6426,
        "end_lineno": 6455,
        "args": [
          "page_id",
          "source",
          "youtube_url"
        ],
        "docstring": "Update Notion with download source information.\n\nArgs:\n    page_id: Notion page ID\n    source: Download source (e.g., \"SoundCloud\", \"YouTube\", \"YouTube (Auto)\")\n    youtube_url: YouTube URL to save (optional)",
        "decorators": []
      },
      {
        "name": "clean_title_advanced",
        "lineno": 6462,
        "end_lineno": 6530,
        "args": [
          "title"
        ],
        "docstring": "Advanced title cleaning with label removal and artist extraction.\nEnhanced version from fix_soundcloud_metadata.py.\n\nArgs:\n    title: Original title string\n    \nReturns:\n    Cleaned title string\n    \nExamples:\n    \"03 Artist - Track Title\" -> \"Track Title\"\n    \"Artist X Artist - Track Title (Remix) Jungle Cakes\" -> \"Track Title (Remix)\"",
        "decorators": []
      },
      {
        "name": "extract_artists_from_title",
        "lineno": 6533,
        "end_lineno": 6579,
        "args": [
          "title"
        ],
        "docstring": "Extract multiple artists from collaboration format in title.\n\nArgs:\n    title: Original title string\n    \nReturns:\n    List of artist names\n    \nExamples:\n    \"Artist1 X Artist2 X Artist3 - Track\" -> [\"Artist1\", \"Artist2\", \"Artist3\"]\n    \"Artist1 & Artist2 - Track\" -> [\"Artist1\", \"Artist2\"]",
        "decorators": []
      },
      {
        "name": "clean_artist_name",
        "lineno": 6582,
        "end_lineno": 6610,
        "args": [
          "artist"
        ],
        "docstring": "Clean up artist name formatting.\n\nArgs:\n    artist: Original artist name\n    \nReturns:\n    Cleaned artist name\n    \nExamples:\n    \"Artist Official\" -> \"Artist\"\n    \"Artist   Music\" -> \"Artist\"",
        "decorators": []
      },
      {
        "name": "is_collaboration",
        "lineno": 6613,
        "end_lineno": 6642,
        "args": [
          "title"
        ],
        "docstring": "Check if title contains artist collaboration (multiple artists).\n\nArgs:\n    title: Original title\n    \nReturns:\n    True if it's a collaboration",
        "decorators": []
      },
      {
        "name": "cleanup_processing_artifacts",
        "lineno": 6648,
        "end_lineno": 6683,
        "args": [
          "temp_dir",
          "profiler",
          "dump_profile",
          "warn_on_error",
          "log_clean"
        ],
        "docstring": "Shut down the profiler and remove a temporary processing directory.",
        "decorators": []
      },
      {
        "name": "_attempt_youtube_fallback",
        "lineno": 6685,
        "end_lineno": 6744,
        "args": [
          "track_info",
          "playlist_dir",
          "playlist_name",
          "custom_temp_dir",
          "profiler"
        ],
        "docstring": "Attempt YouTube-based download fallbacks when SoundCloud retrieval fails.",
        "decorators": []
      },
      {
        "name": "_cleanup_temp_dir_only",
        "lineno": 6705,
        "end_lineno": 6711,
        "args": [],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "download_track",
        "lineno": 6746,
        "end_lineno": 7532,
        "args": [
          "url",
          "playlist_dir",
          "track_info",
          "playlist_name",
          "retry",
          "max_retries"
        ],
        "docstring": "Download, convert, tag, and move files.\nReturns dict for track entry or None on failure.",
        "decorators": []
      },
      {
        "name": "import_and_update",
        "lineno": 7335,
        "end_lineno": 7375,
        "args": [],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 7537,
        "end_lineno": 7834,
        "args": [],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_normalize_uuid_for_query",
        "lineno": 7599,
        "end_lineno": 7604,
        "args": [
          "s"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_fixed_query_database",
        "lineno": 7615,
        "end_lineno": 7645,
        "args": [
          "database_id",
          "body"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_debugging_req",
        "lineno": 7654,
        "end_lineno": 7672,
        "args": [
          "method",
          "path",
          "body",
          "**kwargs"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "fix_eagle_file_id_property_type",
        "lineno": 7836,
        "end_lineno": 7884,
        "args": [],
        "docstring": "Fix the Eagle File ID property type from date to rich_text in the Notion database.",
        "decorators": []
      },
      {
        "name": "verify_audio_processing_quality",
        "lineno": 7886,
        "end_lineno": 8076,
        "args": [
          "audio_samples",
          "sample_rate",
          "processing_report",
          "target_lufs"
        ],
        "docstring": "Comprehensive verification of audio processing quality.\n\nPerforms independent analysis and validates all metrics before file saving.\nOnly returns True if ALL quality checks pass with perfect results.\n\nArgs:\n    audio_samples: Processed audio samples\n    sample_rate: Audio sample rate\n    processing_report: Report from the processing pipeline\n    target_lufs: Target LUFS level\n\nReturns:\n    tuple: (verification_passed, verification_report)",
        "decorators": []
      },
      {
        "name": "iterate_database_query",
        "lineno": 8078,
        "end_lineno": 8172,
        "args": [
          "database_id",
          "base_query",
          "max_items"
        ],
        "docstring": "Yield each page of a paginated Notion database query as soon as it is retrieved.",
        "decorators": []
      },
      {
        "name": "query_database_paginated",
        "lineno": 8175,
        "end_lineno": 8187,
        "args": [
          "database_id",
          "base_query",
          "max_items"
        ],
        "docstring": "POST /databases/{id}/query with start_cursor in body. Preserve filter/sorts.\n\nReturns the accumulated results, while underlying pagination can still be streamed\nvia iterate_database_query when immediate processing is preferred.",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "_WorkspaceFallbackLogger",
        "lineno": 100,
        "end_lineno": 126,
        "docstring": null,
        "bases": []
      },
      {
        "name": "WorkspaceLoggerAdapter",
        "lineno": 199,
        "end_lineno": 261,
        "docstring": "Adapter exposing legacy helper methods on top of the shared-core logger.",
        "bases": []
      },
      {
        "name": "NotionManager",
        "lineno": 2071,
        "end_lineno": 2138,
        "docstring": "Notion API manager following workspace standards",
        "bases": []
      },
      {
        "name": "_SuppressNTNWarning",
        "lineno": 2140,
        "end_lineno": 2146,
        "docstring": null,
        "bases": [
          "logging.Filter"
        ]
      },
      {
        "name": "GeoRestrictedError",
        "lineno": 6179,
        "end_lineno": 6181,
        "docstring": "Raised when content is geo-restricted or blocked in current region.",
        "bases": [
          "Exception"
        ]
      },
      {
        "name": "DownloadSourceUnavailableError",
        "lineno": 6184,
        "end_lineno": 6186,
        "docstring": "Raised when all download sources have been exhausted.",
        "bases": [
          "Exception"
        ]
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/soundcloud_notion_integration.py",
    "line_count": 1401,
    "imports": [
      "aiohttp",
      "argparse",
      "asyncio",
      "concurrent.futures",
      "dataclasses",
      "datetime",
      "dotenv",
      "enhanced_integrated_matcher",
      "functools",
      "json",
      "logging",
      "notion_client",
      "notion_client.errors",
      "os",
      "pathlib",
      "random",
      "rapidfuzz",
      "re",
      "requests",
      "sys",
      "threading",
      "time",
      "traceback",
      "typing",
      "yt_dlp"
    ],
    "functions": [
      {
        "name": "run_startup_tests",
        "lineno": 1,
        "end_lineno": 116,
        "args": [],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_progress_report",
        "lineno": 196,
        "end_lineno": 210,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 215,
        "end_lineno": 216,
        "args": [
          "self",
          "log_level"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "setup_logging",
        "lineno": 218,
        "end_lineno": 238,
        "args": [
          "self",
          "log_level"
        ],
        "docstring": "Configure comprehensive logging system.",
        "decorators": []
      },
      {
        "name": "info",
        "lineno": 240,
        "end_lineno": 245,
        "args": [
          "self",
          "message",
          "extra_data"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "error",
        "lineno": 247,
        "end_lineno": 258,
        "args": [
          "self",
          "message",
          "error",
          "extra_data"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "warning",
        "lineno": 260,
        "end_lineno": 265,
        "args": [
          "self",
          "message",
          "extra_data"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 270,
        "end_lineno": 275,
        "args": [
          "self",
          "calls_per_second"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "wait_if_needed",
        "lineno": 277,
        "end_lineno": 288,
        "args": [
          "self"
        ],
        "docstring": "Wait if necessary to respect rate limits.",
        "decorators": []
      },
      {
        "name": "retry_with_backoff",
        "lineno": 290,
        "end_lineno": 322,
        "args": [
          "max_retries",
          "base_delay",
          "max_delay"
        ],
        "docstring": "Decorator for retry logic with exponential backoff.",
        "decorators": []
      },
      {
        "name": "decorator",
        "lineno": 292,
        "end_lineno": 321,
        "args": [
          "func"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "wrapper",
        "lineno": 294,
        "end_lineno": 320,
        "args": [
          "*args",
          "**kwargs"
        ],
        "docstring": null,
        "decorators": [
          "wraps(func)"
        ]
      },
      {
        "name": "__init__",
        "lineno": 335,
        "end_lineno": 340,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "normalize_artist",
        "lineno": 343,
        "end_lineno": 358,
        "args": [
          "artist"
        ],
        "docstring": "Normalize artist name for consistent matching.",
        "decorators": [
          "staticmethod"
        ]
      },
      {
        "name": "normalize_title",
        "lineno": 361,
        "end_lineno": 371,
        "args": [
          "title"
        ],
        "docstring": "Normalize track title for consistent matching.",
        "decorators": [
          "staticmethod"
        ]
      },
      {
        "name": "calculate_match_confidence",
        "lineno": 374,
        "end_lineno": 399,
        "args": [
          "artist_sim",
          "title_sim",
          "duration_diff",
          "duration_tolerance"
        ],
        "docstring": "Calculate overall match confidence score.",
        "decorators": [
          "staticmethod"
        ]
      },
      {
        "name": "find_best_match",
        "lineno": 401,
        "end_lineno": 419,
        "args": [
          "self",
          "spotify_artist",
          "spotify_title",
          "spotify_duration",
          "soundcloud_tracks"
        ],
        "docstring": "Find the best matching SoundCloud track using enhanced matching if available.",
        "decorators": []
      },
      {
        "name": "_find_best_match_enhanced",
        "lineno": 421,
        "end_lineno": 464,
        "args": [
          "self",
          "spotify_artist",
          "spotify_title",
          "spotify_duration",
          "soundcloud_tracks"
        ],
        "docstring": "Enhanced matching using the integrated matcher.",
        "decorators": []
      },
      {
        "name": "_find_best_match_basic",
        "lineno": 466,
        "end_lineno": 533,
        "args": [
          "self",
          "spotify_artist",
          "spotify_title",
          "spotify_duration",
          "soundcloud_tracks"
        ],
        "docstring": "Basic matching using original algorithm.",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 539,
        "end_lineno": 545,
        "args": [
          "self",
          "logger"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_database_schema",
        "lineno": 548,
        "end_lineno": 577,
        "args": [
          "self",
          "database_id"
        ],
        "docstring": "Retrieve and cache database schema.",
        "decorators": [
          "retry_with_backoff(max_retries=3)"
        ]
      },
      {
        "name": "query_music_tracks",
        "lineno": 580,
        "end_lineno": 653,
        "args": [
          "self"
        ],
        "docstring": "Query all music tracks from the Notion database.",
        "decorators": [
          "retry_with_backoff(max_retries=3)"
        ]
      },
      {
        "name": "update_track_with_soundcloud_url",
        "lineno": 656,
        "end_lineno": 698,
        "args": [
          "self",
          "page_id",
          "soundcloud_url",
          "match_confidence",
          "youtube_url"
        ],
        "docstring": "Update a Notion page with SoundCloud URL, YouTube URL and match confidence.",
        "decorators": [
          "retry_with_backoff(max_retries=3)"
        ]
      },
      {
        "name": "update_track_with_playlists",
        "lineno": 701,
        "end_lineno": 718,
        "args": [
          "self",
          "page_id",
          "playlist_ids"
        ],
        "docstring": "Update the Playlist relation property for a track.",
        "decorators": [
          "retry_with_backoff(max_retries=3)"
        ]
      },
      {
        "name": "log_interaction",
        "lineno": 721,
        "end_lineno": 785,
        "args": [
          "self",
          "interaction_data"
        ],
        "docstring": "Log interaction to the Interactions database.",
        "decorators": [
          "retry_with_backoff(max_retries=3)"
        ]
      },
      {
        "name": "__init__",
        "lineno": 792,
        "end_lineno": 816,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "extract_track_info",
        "lineno": 819,
        "end_lineno": 849,
        "args": [
          "self",
          "notion_page"
        ],
        "docstring": "Extract track information from Notion page.",
        "decorators": []
      },
      {
        "name": "process_single_track",
        "lineno": 851,
        "end_lineno": 1031,
        "args": [
          "self",
          "notion_page"
        ],
        "docstring": "Process a single track for SoundCloud matching with retry search strategy and YouTube fallback.",
        "async": true,
        "decorators": []
      },
      {
        "name": "process_batch",
        "lineno": 1033,
        "end_lineno": 1069,
        "args": [
          "self",
          "tracks_batch"
        ],
        "docstring": "Process a batch of tracks concurrently.",
        "decorators": []
      },
      {
        "name": "get_playlist_tracks",
        "lineno": 1071,
        "end_lineno": 1142,
        "args": [
          "self",
          "playlist_url",
          "limit"
        ],
        "docstring": "Fetch tracks from a SoundCloud playlist using yt-dlp.\n\nArgs:\n    playlist_url: SoundCloud playlist URL\n    limit: Maximum number of tracks to fetch\n    \nReturns:\n    List of track dictionaries with metadata",
        "decorators": []
      },
      {
        "name": "export_results",
        "lineno": 1144,
        "end_lineno": 1174,
        "args": [
          "self",
          "filename"
        ],
        "docstring": "Export results to JSON file with timestamp.",
        "decorators": []
      },
      {
        "name": "run_integration",
        "lineno": 1176,
        "end_lineno": 1337,
        "args": [
          "self",
          "batch_size",
          "test_mode",
          "limit"
        ],
        "docstring": "Run the complete integration process.",
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 1339,
        "end_lineno": 1398,
        "args": [],
        "docstring": "Main entry point.",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "MatchResult",
        "lineno": 175,
        "end_lineno": 183,
        "docstring": "Represents a SoundCloud match result for a Spotify track.",
        "bases": []
      },
      {
        "name": "ProcessingStats",
        "lineno": 186,
        "end_lineno": 210,
        "docstring": "Track processing statistics and progress.",
        "bases": []
      },
      {
        "name": "Logger",
        "lineno": 212,
        "end_lineno": 265,
        "docstring": "Centralized logging with JSON formatting and file rotation.",
        "bases": []
      },
      {
        "name": "RateLimiter",
        "lineno": 267,
        "end_lineno": 288,
        "docstring": "Thread-safe rate limiter for API calls.",
        "bases": []
      },
      {
        "name": "MusicMatcher",
        "lineno": 332,
        "end_lineno": 533,
        "docstring": "Enhanced music matching algorithms for cross-platform identification.",
        "bases": []
      },
      {
        "name": "NotionManager",
        "lineno": 536,
        "end_lineno": 785,
        "docstring": "Notion API manager with comprehensive error handling and rate limiting.",
        "bases": []
      },
      {
        "name": "SoundCloudMusicIntegration",
        "lineno": 789,
        "end_lineno": 1337,
        "docstring": "Main integration class coordinating all operations.",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/soundcloud_notion_integration_backup.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/spotify-download-dual-output.py",
    "error": "SyntaxError: closing parenthesis ')' does not match opening parenthesis '{' on line 567 (<unknown>, line 568)"
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/spotify_incremental_sync_backup.py",
    "line_count": 530,
    "imports": [
      "datetime",
      "difflib",
      "dotenv",
      "logging",
      "notion_music_db",
      "os",
      "pickle",
      "re",
      "rekordbox_api",
      "requests",
      "spotify_api",
      "sys",
      "time"
    ],
    "functions": [
      {
        "name": "normalize_text_for_comparison",
        "lineno": 50,
        "end_lineno": 62,
        "args": [
          "text"
        ],
        "docstring": "Normalize text for comparison by removing special characters and converting to lowercase.",
        "decorators": []
      },
      {
        "name": "calculate_similarity",
        "lineno": 64,
        "end_lineno": 75,
        "args": [
          "str1",
          "str2"
        ],
        "docstring": "Calculate similarity between two strings using SequenceMatcher.",
        "decorators": []
      },
      {
        "name": "load_state",
        "lineno": 77,
        "end_lineno": 108,
        "args": [],
        "docstring": "Load the current sync state from file.",
        "decorators": []
      },
      {
        "name": "save_state",
        "lineno": 110,
        "end_lineno": 129,
        "args": [
          "state"
        ],
        "docstring": "Save the current sync state to file.",
        "decorators": []
      },
      {
        "name": "check_if_track_exists",
        "lineno": 131,
        "end_lineno": 266,
        "args": [
          "track",
          "notion",
          "state"
        ],
        "docstring": "Check if a track already exists in the Notion database using multiple strategies:\n1. Exact Spotify ID match (check state first for efficiency)\n2. Exact title + artist match\n3. Fuzzy title + artist match (85% similarity)\n4. Fuzzy title with artist similarity (85% title, 70% artist)",
        "decorators": []
      },
      {
        "name": "create_safe_notion_properties",
        "lineno": 268,
        "end_lineno": 392,
        "args": [
          "track",
          "source"
        ],
        "docstring": "Create Notion properties with proper error handling and validation.",
        "decorators": []
      },
      {
        "name": "find_next_unprocessed_track",
        "lineno": 394,
        "end_lineno": 452,
        "args": [
          "spotify",
          "notion",
          "state"
        ],
        "docstring": "Find the next unprocessed track by scanning backward through Spotify liked songs.\nReturns the first unprocessed track found, or None if all tracks are processed.",
        "decorators": []
      },
      {
        "name": "process_single_track_with_state",
        "lineno": 454,
        "end_lineno": 519,
        "args": [],
        "docstring": "Process a single unprocessed track with state tracking.\nThis ensures the entire library gets processed over time.",
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 521,
        "end_lineno": 527,
        "args": [],
        "docstring": "Run the incremental sync script.",
        "decorators": []
      }
    ],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/spotify_playlists_to_notion.py",
    "line_count": 534,
    "imports": [
      "dotenv",
      "json",
      "notion_client",
      "notion_music_db",
      "os",
      "spotify_api",
      "sys",
      "time",
      "typing"
    ],
    "functions": [
      {
        "name": "__init__",
        "lineno": 48,
        "end_lineno": 63,
        "args": [
          "self"
        ],
        "docstring": "Initialize with existing infrastructure.",
        "decorators": []
      },
      {
        "name": "fetch_user_playlists",
        "lineno": 65,
        "end_lineno": 99,
        "args": [
          "self",
          "limit"
        ],
        "docstring": "Fetch user's Spotify playlists.\n\nArgs:\n    limit: Maximum number of playlists to fetch\n    \nReturns:\n    List of playlist dictionaries with metadata",
        "decorators": []
      },
      {
        "name": "fetch_playlist_tracks",
        "lineno": 101,
        "end_lineno": 153,
        "args": [
          "self",
          "playlist_id",
          "limit"
        ],
        "docstring": "Fetch tracks from a specific Spotify playlist.\n\nArgs:\n    playlist_id: Spotify playlist ID\n    limit: Maximum number of tracks to fetch\n    \nReturns:\n    List of track dictionaries with metadata",
        "decorators": []
      },
      {
        "name": "upsert_playlist_page",
        "lineno": 155,
        "end_lineno": 262,
        "args": [
          "self",
          "playlist"
        ],
        "docstring": "Find existing playlist page or create a new one.\n\nArgs:\n    playlist: Playlist metadata dictionary\n    \nReturns:\n    Notion page ID if successful, None otherwise",
        "decorators": []
      },
      {
        "name": "append_track_list",
        "lineno": 264,
        "end_lineno": 357,
        "args": [
          "self",
          "page_id",
          "tracks",
          "playlist_name"
        ],
        "docstring": "Append track listing to the Notion page.\n\nArgs:\n    page_id: Notion page ID\n    tracks: List of track dictionaries\n    playlist_name: Name of the playlist for the heading",
        "decorators": []
      },
      {
        "name": "process_single_playlist",
        "lineno": 359,
        "end_lineno": 395,
        "args": [
          "self",
          "playlist"
        ],
        "docstring": "Process a single playlist: create/update page and add tracks.\n\nArgs:\n    playlist: Playlist metadata dictionary\n    \nReturns:\n    True if successful, False otherwise",
        "decorators": []
      },
      {
        "name": "run",
        "lineno": 397,
        "end_lineno": 496,
        "args": [
          "self",
          "playlist_limit",
          "track_limit"
        ],
        "docstring": "Main execution method: fetch all playlists and process them.\n\nArgs:\n    playlist_limit: Maximum number of playlists to process\n    track_limit: Maximum number of tracks per playlist\n    \nReturns:\n    Summary dictionary with results",
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 499,
        "end_lineno": 530,
        "args": [],
        "docstring": "Main entry point for the script.",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "SpotifyPlaylistsToNotion",
        "lineno": 42,
        "end_lineno": 496,
        "docstring": "Main class for Spotify playlists to Notion integration.\nLeverages existing Seren Media infrastructure.",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/spotify_to_notion_artists_only_full_fixed.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/spotify_to_notion_enhanced_with_logging.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/test_core_workflow_clean.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/test_spotify_tracks_with_verification.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/ultimate_music_workflow_fixed.py",
    "line_count": 1265,
    "imports": [
      "argparse",
      "asyncio",
      "audio.analyzer",
      "audio.fingerprint",
      "audio.metadata",
      "audio.normalizer",
      "audio.optimized_processor",
      "collections",
      "concurrent.futures",
      "datetime",
      "dotenv",
      "downloaders.youtube",
      "eagle.client",
      "enum",
      "functools",
      "hashlib",
      "inspect",
      "json",
      "logging",
      "musicbot.oauth.manager",
      "musicbot.spotify.client",
      "notion.enhanced_client",
      "os",
      "pathlib",
      "processing.enhanced_orchestrator",
      "processing.pipeline",
      "processing.single_track_orchestrator_dual",
      "shutil",
      "soundcloud.soundcloud_service",
      "soundcloud_init",
      "subprocess",
      "sys",
      "time",
      "traceback",
      "typing",
      "unified_config",
      "unified_state_registry",
      "utils.circuit_breaker",
      "utils.csv_backup",
      "utils.duplicate_detector",
      "utils.enhanced_state_tracker",
      "utils.heartbeat",
      "utils.memory_manager",
      "utils.performance_monitor",
      "utils.rate_limiter",
      "utils.state_tracker"
    ],
    "functions": [
      {
        "name": "__init__",
        "lineno": 117,
        "end_lineno": 118,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_load_comprehensive_config",
        "lineno": 120,
        "end_lineno": 211,
        "args": [
          "self"
        ],
        "docstring": "Load complete configuration from environment and defaults.",
        "decorators": []
      },
      {
        "name": "validate",
        "lineno": 213,
        "end_lineno": 231,
        "args": [
          "self"
        ],
        "docstring": "Validate configuration and return status with errors.",
        "decorators": []
      },
      {
        "name": "add_error",
        "lineno": 287,
        "end_lineno": 295,
        "args": [
          "self",
          "error",
          "context"
        ],
        "docstring": "Add error to metrics.",
        "decorators": []
      },
      {
        "name": "get_duration",
        "lineno": 297,
        "end_lineno": 300,
        "args": [
          "self"
        ],
        "docstring": "Get workflow duration.",
        "decorators": []
      },
      {
        "name": "get_summary",
        "lineno": 302,
        "end_lineno": 337,
        "args": [
          "self"
        ],
        "docstring": "Get comprehensive metrics summary.",
        "decorators": []
      },
      {
        "name": "_is_permalink",
        "lineno": 343,
        "end_lineno": 344,
        "args": [
          "u"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 352,
        "end_lineno": 370,
        "args": [
          "self",
          "config"
        ],
        "docstring": "Initialize the ultimate workflow with all components.",
        "decorators": []
      },
      {
        "name": "_init_services",
        "lineno": 372,
        "end_lineno": 416,
        "args": [
          "self"
        ],
        "docstring": "Initialize all service clients.",
        "decorators": []
      },
      {
        "name": "_init_state_management",
        "lineno": 418,
        "end_lineno": 433,
        "args": [
          "self"
        ],
        "docstring": "Initialize comprehensive state management.",
        "decorators": []
      },
      {
        "name": "_init_utilities",
        "lineno": 435,
        "end_lineno": 480,
        "args": [
          "self"
        ],
        "docstring": "Initialize all utility components.",
        "decorators": []
      },
      {
        "name": "_init_processing",
        "lineno": 482,
        "end_lineno": 516,
        "args": [
          "self"
        ],
        "docstring": "Initialize processing components.",
        "decorators": []
      },
      {
        "name": "fetch_all_tracks",
        "lineno": 518,
        "end_lineno": 557,
        "args": [
          "self"
        ],
        "docstring": "Fetch tracks from all configured sources.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_fetch_spotify_tracks",
        "lineno": 559,
        "end_lineno": 583,
        "args": [
          "self"
        ],
        "docstring": "Fetch tracks from Spotify with comprehensive options.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_fetch_soundcloud_tracks",
        "lineno": 585,
        "end_lineno": 610,
        "args": [
          "self"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "_fetch_existing_soundcloud_tracks_from_notion",
        "lineno": 612,
        "end_lineno": 653,
        "args": [
          "self"
        ],
        "docstring": "Fetch existing SoundCloud tracks from Notion using yt-dlp integration.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_fetch_youtube_tracks",
        "lineno": 655,
        "end_lineno": 661,
        "args": [
          "self"
        ],
        "docstring": "Fetch tracks from YouTube playlists.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_convert_spotify_track",
        "lineno": 663,
        "end_lineno": 672,
        "args": [
          "self",
          "spotify_track"
        ],
        "docstring": "Convert Spotify track data to Track object.",
        "decorators": []
      },
      {
        "name": "_convert_soundcloud_track",
        "lineno": 674,
        "end_lineno": 683,
        "args": [
          "self",
          "soundcloud_track"
        ],
        "docstring": "Convert SoundCloud track data to Track object.",
        "decorators": []
      },
      {
        "name": "process_tracks",
        "lineno": 685,
        "end_lineno": 736,
        "args": [
          "self",
          "tracks"
        ],
        "docstring": "Process all tracks with comprehensive pipeline.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_process_batch_parallel",
        "lineno": 738,
        "end_lineno": 760,
        "args": [
          "self",
          "batch"
        ],
        "docstring": "Process batch with parallel workers.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_process_batch_sequential",
        "lineno": 762,
        "end_lineno": 777,
        "args": [
          "self",
          "batch"
        ],
        "docstring": "Process batch sequentially.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_process_single_track_sync",
        "lineno": 779,
        "end_lineno": 786,
        "args": [
          "self",
          "track"
        ],
        "docstring": "Synchronous wrapper for single track processing.",
        "decorators": []
      },
      {
        "name": "_process_single_track",
        "lineno": 788,
        "end_lineno": 854,
        "args": [
          "self",
          "track"
        ],
        "docstring": "Process single track with all enhancements.",
        "async": true,
        "decorators": []
      },
      {
        "name": "sync_to_notion",
        "lineno": 856,
        "end_lineno": 887,
        "args": [
          "self",
          "processed_tracks"
        ],
        "docstring": "Sync all processed tracks to Notion.",
        "async": true,
        "decorators": []
      },
      {
        "name": "create_backups",
        "lineno": 889,
        "end_lineno": 910,
        "args": [
          "self",
          "processed_tracks"
        ],
        "docstring": "Create comprehensive backups.",
        "async": true,
        "decorators": []
      },
      {
        "name": "generate_report",
        "lineno": 912,
        "end_lineno": 957,
        "args": [
          "self"
        ],
        "docstring": "Generate comprehensive workflow report.",
        "decorators": []
      },
      {
        "name": "run",
        "lineno": 959,
        "end_lineno": 1078,
        "args": [
          "self",
          "spotify_limit",
          "soundcloud_limit",
          "youtube_limit"
        ],
        "docstring": "Run the ultimate workflow with all features.\n\nArgs:\n    spotify_limit: Limit Spotify tracks (for testing)\n    soundcloud_limit: Limit SoundCloud tracks (for testing)\n    youtube_limit: Limit YouTube tracks (for testing)",
        "async": true,
        "decorators": []
      },
      {
        "name": "create_parser",
        "lineno": 1084,
        "end_lineno": 1211,
        "args": [],
        "docstring": "Create comprehensive CLI argument parser.",
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 1217,
        "end_lineno": 1255,
        "args": [],
        "docstring": "Main entry point for the ultimate workflow.",
        "async": true,
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "ConfigurationManager",
        "lineno": 114,
        "end_lineno": 231,
        "docstring": "Centralized configuration management with all features.",
        "bases": []
      },
      {
        "name": "WorkflowState",
        "lineno": 237,
        "end_lineno": 246,
        "docstring": "Workflow execution states.",
        "bases": [
          "Enum"
        ]
      },
      {
        "name": "WorkflowMetrics",
        "lineno": 253,
        "end_lineno": 337,
        "docstring": "Comprehensive workflow metrics tracking.",
        "bases": []
      },
      {
        "name": "UltimateMusicWorkflow",
        "lineno": 346,
        "end_lineno": 1078,
        "docstring": "The most comprehensive music workflow orchestrator.\nCombines all features from the entire codebase.",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/unified_music_sync_orchestrator.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/unified_music_workflow copy.py",
    "line_count": 670,
    "imports": [
      "__future__",
      "aiohttp",
      "argparse",
      "asyncio",
      "dataclasses",
      "datetime",
      "difflib",
      "dotenv",
      "enum",
      "logging",
      "logging.handlers",
      "os",
      "pathlib",
      "random",
      "rapidfuzz",
      "spotify_oauth_manager",
      "time",
      "typing",
      "yt_dlp"
    ],
    "functions": [
      {
        "name": "_fetch_json",
        "lineno": 77,
        "end_lineno": 114,
        "args": [
          "session",
          "method",
          "url",
          "headers",
          "params",
          "json_body",
          "max_retries"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 129,
        "end_lineno": 136,
        "args": [
          "self",
          "token",
          "tracks_db_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_headers",
        "lineno": 138,
        "end_lineno": 143,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "find_track_by_spotify_id",
        "lineno": 145,
        "end_lineno": 157,
        "args": [
          "self",
          "spotify_id"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "create_track",
        "lineno": 159,
        "end_lineno": 173,
        "args": [
          "self",
          "track",
          "soundcloud_url"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "update_track_soundcloud_url",
        "lineno": 175,
        "end_lineno": 179,
        "args": [
          "self",
          "page_id",
          "url"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "find_playlist_by_spotify_id",
        "lineno": 181,
        "end_lineno": 190,
        "args": [
          "self",
          "spotify_playlist_id"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "create_playlist",
        "lineno": 192,
        "end_lineno": 202,
        "args": [
          "self",
          "name",
          "spotify_playlist_id",
          "snapshot_id"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "update_playlist_snapshot",
        "lineno": 204,
        "end_lineno": 208,
        "args": [
          "self",
          "page_id",
          "snapshot_id"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "get_memberships_for_playlist",
        "lineno": 210,
        "end_lineno": 238,
        "args": [
          "self",
          "playlist_page_id"
        ],
        "docstring": "Return a mapping of Spotify Track ID -> membership page id for a given playlist page.",
        "async": true,
        "decorators": []
      },
      {
        "name": "upsert_membership",
        "lineno": 240,
        "end_lineno": 253,
        "args": [
          "self",
          "playlist_page_id",
          "track_page_id",
          "position",
          "added_at_iso"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "update_membership_present",
        "lineno": 255,
        "end_lineno": 259,
        "args": [
          "self",
          "membership_page_id",
          "present"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "get_state",
        "lineno": 261,
        "end_lineno": 273,
        "args": [
          "self",
          "key"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "set_state",
        "lineno": 275,
        "end_lineno": 294,
        "args": [
          "self",
          "key",
          "value"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 303,
        "end_lineno": 315,
        "args": [
          "self",
          "token"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_get_token",
        "lineno": 317,
        "end_lineno": 321,
        "args": [
          "self"
        ],
        "docstring": "Get a valid access token.",
        "decorators": []
      },
      {
        "name": "get_liked_songs",
        "lineno": 323,
        "end_lineno": 346,
        "args": [
          "self",
          "limit",
          "offset"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "list_my_playlists",
        "lineno": 348,
        "end_lineno": 355,
        "args": [
          "self",
          "limit",
          "offset"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "get_playlist_items",
        "lineno": 357,
        "end_lineno": 377,
        "args": [
          "self",
          "playlist_id"
        ],
        "docstring": "Return (snapshot_id, items) where items include 'track' and 'added_at'.",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 388,
        "end_lineno": 410,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_search_sync",
        "lineno": 412,
        "end_lineno": 460,
        "args": [
          "self",
          "title",
          "artist"
        ],
        "docstring": "Search SoundCloud for a track and return the best URL and confidence.\n\nThe function returns a tuple of ``(url, confidence)``, where\n``url`` is the best matched SoundCloud URL or ``None`` and\n``confidence`` is a float between 0 and 1.  Confidence is\ncalculated using RapidFuzz if available; otherwise, a simple\nnormalised match ratio is used.",
        "decorators": []
      },
      {
        "name": "search",
        "lineno": 462,
        "end_lineno": 463,
        "args": [
          "self",
          "title",
          "artist"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "search_async",
        "lineno": 465,
        "end_lineno": 472,
        "args": [
          "self",
          "title",
          "artist"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 485,
        "end_lineno": 493,
        "args": [
          "self",
          "notion_service",
          "spotify_service",
          "soundcloud_service",
          "batch_limit"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "sync_liked_songs",
        "lineno": 495,
        "end_lineno": 536,
        "args": [
          "self"
        ],
        "docstring": "Fetch all liked songs with pagination and incremental cutoff by added_at.",
        "async": true,
        "decorators": []
      },
      {
        "name": "sync_playlists",
        "lineno": 538,
        "end_lineno": 589,
        "args": [
          "self"
        ],
        "docstring": "Sync all user playlists, their tracks, and membership state using snapshot_id diffs.",
        "async": true,
        "decorators": []
      },
      {
        "name": "process_track",
        "lineno": 591,
        "end_lineno": 615,
        "args": [
          "self",
          "track"
        ],
        "docstring": "Process a single track from Spotify.\n\nSteps:\n1. Check whether the track already exists in Notion.\n2. If it doesn't exist, search SoundCloud for a match.\n3. Create the track in Notion with the SoundCloud URL (if found).\n4. If it exists but lacks a SoundCloud URL, update the page.",
        "async": true,
        "decorators": []
      },
      {
        "name": "run_batch",
        "lineno": 617,
        "end_lineno": 625,
        "args": [
          "self",
          "limit",
          "offset"
        ],
        "docstring": "Run the batch synchronisation.\n\nFetches a batch of liked songs from Spotify and processes them\nconcurrently with bounded concurrency.  Be mindful of API rate limits.",
        "async": true,
        "decorators": []
      },
      {
        "name": "main_async",
        "lineno": 632,
        "end_lineno": 656,
        "args": [
          "mode",
          "limit",
          "offset"
        ],
        "docstring": "Async wrapper for main execution.\n\n:param mode: currently only 'batch' is implemented\n:param limit: number of tracks to fetch per batch\n:param offset: offset into the liked songs list",
        "async": true,
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 659,
        "end_lineno": 666,
        "args": [],
        "docstring": null,
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "TrackSource",
        "lineno": 54,
        "end_lineno": 56,
        "docstring": null,
        "bases": [
          "str",
          "Enum"
        ]
      },
      {
        "name": "Track",
        "lineno": 63,
        "end_lineno": 70,
        "docstring": "A simple representation of a music track.",
        "bases": []
      },
      {
        "name": "NotionService",
        "lineno": 121,
        "end_lineno": 294,
        "docstring": "Service wrapper for Notion interactions.\n\nThis class encapsulates all interactions with Notion.  The methods\nprovided here are intentionally simple.  Replace the `TODO` sections\nwith calls to the official Notion API or your preferred client.",
        "bases": []
      },
      {
        "name": "SpotifyService",
        "lineno": 297,
        "end_lineno": 377,
        "docstring": "Service wrapper for Spotify interactions.\n\nThis class provides methods to fetch liked songs and playlists using the OAuth manager.",
        "bases": []
      },
      {
        "name": "SoundCloudService",
        "lineno": 380,
        "end_lineno": 472,
        "docstring": "Service wrapper for SoundCloud searches.\n\nUses `yt_dlp` to perform web searches on the public SoundCloud site.\nThe search is performed by constructing a query string and passing\nit to ``scsearch``.  See ``yt-dlp`` documentation for details.",
        "bases": []
      },
      {
        "name": "MusicSyncOrchestrator",
        "lineno": 482,
        "end_lineno": 625,
        "docstring": "Coordinates the entire synchronization process.",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/unified_music_workflow.py",
    "error": "SyntaxError: unmatched '}' (<unknown>, line 801)"
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/unified_music_workflow_enhanced.py",
    "line_count": 2321,
    "imports": [
      "aiohttp",
      "asyncio",
      "collections",
      "csv",
      "dataclasses",
      "datetime",
      "dotenv",
      "email.utils",
      "enum",
      "json",
      "logging",
      "os",
      "pathlib",
      "random",
      "rapidfuzz",
      "re",
      "requests",
      "spotify_oauth_manager",
      "time",
      "typing",
      "unicodedata",
      "urllib.parse",
      "yt_dlp"
    ],
    "functions": [
      {
        "name": "_parse_retry_after",
        "lineno": 31,
        "end_lineno": 88,
        "args": [
          "headers",
          "default_seconds"
        ],
        "docstring": "Parse Retry-After header robustly:\n- If numeric and > 1e9, treat as UNIX timestamp (seconds since epoch).\n- If numeric and > 1000, treat as milliseconds and convert to seconds.\n- If HTTP-date, parse and compute delta from now.\n- Else treat as seconds.\nReturns a sane clamped value with no negatives.",
        "decorators": []
      },
      {
        "name": "_fetch_json",
        "lineno": 90,
        "end_lineno": 178,
        "args": [
          "session",
          "method",
          "url",
          "headers",
          "params",
          "json_body",
          "timeout"
        ],
        "docstring": "Robust HTTP request handler with rate limiting, polite pacing, and intelligent retry logic.",
        "async": true,
        "decorators": []
      },
      {
        "name": "format",
        "lineno": 193,
        "end_lineno": 203,
        "args": [
          "self",
          "record"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 220,
        "end_lineno": 225,
        "args": [
          "self",
          "interval_seconds"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "update_operation",
        "lineno": 227,
        "end_lineno": 234,
        "args": [
          "self",
          "operation",
          "increment"
        ],
        "docstring": "Update operation counter and check if heartbeat is needed.",
        "decorators": []
      },
      {
        "name": "set_current_operation",
        "lineno": 236,
        "end_lineno": 238,
        "args": [
          "self",
          "operation"
        ],
        "docstring": "Set the current operation being performed.",
        "decorators": []
      },
      {
        "name": "_print_heartbeat",
        "lineno": 240,
        "end_lineno": 253,
        "args": [
          "self"
        ],
        "docstring": "Print a concise heartbeat update.",
        "decorators": []
      },
      {
        "name": "final_summary",
        "lineno": 255,
        "end_lineno": 265,
        "args": [
          "self"
        ],
        "docstring": "Print final summary when operation completes.",
        "decorators": []
      },
      {
        "name": "get_normalized_name",
        "lineno": 299,
        "end_lineno": 301,
        "args": [
          "self"
        ],
        "docstring": "Get normalized track name for comparison.",
        "decorators": []
      },
      {
        "name": "get_normalized_artists",
        "lineno": 303,
        "end_lineno": 305,
        "args": [
          "self"
        ],
        "docstring": "Get normalized artist names for comparison.",
        "decorators": []
      },
      {
        "name": "get_normalized_album",
        "lineno": 307,
        "end_lineno": 309,
        "args": [
          "self"
        ],
        "docstring": "Get normalized album name for comparison.",
        "decorators": []
      },
      {
        "name": "_normalize_text",
        "lineno": 311,
        "end_lineno": 322,
        "args": [
          "self",
          "text"
        ],
        "docstring": "Normalize text for comparison (remove accents, special chars, etc.).",
        "decorators": []
      },
      {
        "name": "get_artist_variations",
        "lineno": 324,
        "end_lineno": 335,
        "args": [
          "self"
        ],
        "docstring": "Get variations of artist names (split by feat., &, etc.).",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 344,
        "end_lineno": 349,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "add_track_to_cache",
        "lineno": 351,
        "end_lineno": 369,
        "args": [
          "self",
          "track_id",
          "track_data"
        ],
        "docstring": "Add a track to the duplicate detection cache.",
        "decorators": []
      },
      {
        "name": "find_duplicates",
        "lineno": 371,
        "end_lineno": 490,
        "args": [
          "self",
          "track"
        ],
        "docstring": "Find potential duplicates using multiple strategies with enhanced sensitivity.",
        "decorators": []
      },
      {
        "name": "_calculate_artist_similarity",
        "lineno": 492,
        "end_lineno": 513,
        "args": [
          "self",
          "artists1",
          "artists2"
        ],
        "docstring": "Calculate similarity between two artist lists.",
        "decorators": []
      },
      {
        "name": "_normalize_text",
        "lineno": 515,
        "end_lineno": 523,
        "args": [
          "self",
          "text"
        ],
        "docstring": "Normalize text for comparison.",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 532,
        "end_lineno": 556,
        "args": [
          "self",
          "backup_dir"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_initialize_csv_files",
        "lineno": 558,
        "end_lineno": 571,
        "args": [
          "self"
        ],
        "docstring": "Initialize CSV files with headers.",
        "decorators": []
      },
      {
        "name": "backup_track",
        "lineno": 573,
        "end_lineno": 600,
        "args": [
          "self",
          "track_data"
        ],
        "docstring": "Backup a track to CSV.",
        "decorators": []
      },
      {
        "name": "backup_artist",
        "lineno": 602,
        "end_lineno": 620,
        "args": [
          "self",
          "artist_data"
        ],
        "docstring": "Backup an artist to CSV.",
        "decorators": []
      },
      {
        "name": "backup_playlist",
        "lineno": 622,
        "end_lineno": 642,
        "args": [
          "self",
          "playlist_data"
        ],
        "docstring": "Backup a playlist to CSV.",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 658,
        "end_lineno": 662,
        "args": [
          "self",
          "token",
          "market",
          "oauth_manager"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_refresh_token",
        "lineno": 664,
        "end_lineno": 669,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_liked_songs",
        "lineno": 671,
        "end_lineno": 684,
        "args": [
          "self",
          "limit",
          "offset"
        ],
        "docstring": "Get user's liked songs. Spotify returns them in reverse chronological order (newest first).",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_audio_features",
        "lineno": 686,
        "end_lineno": 710,
        "args": [
          "self",
          "track_ids"
        ],
        "docstring": "Get audio features for multiple tracks.",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_artist_details",
        "lineno": 712,
        "end_lineno": 736,
        "args": [
          "self",
          "artist_ids"
        ],
        "docstring": "Get detailed artist information.",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_track_details",
        "lineno": 738,
        "end_lineno": 749,
        "args": [
          "self",
          "track_id"
        ],
        "docstring": "Get detailed track information including album and ISRC.",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 758,
        "end_lineno": 764,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "search_track",
        "lineno": 766,
        "end_lineno": 861,
        "args": [
          "self",
          "track_name",
          "artist_name",
          "duration_ms",
          "artist_list"
        ],
        "docstring": "Find a reliable SoundCloud webpage URL by requiring:\n- strong title token overlap or high fuzzy score\n- artist token overlap with uploader name or title\n- optional duration tolerance when available",
        "async": true,
        "decorators": []
      },
      {
        "name": "norm",
        "lineno": 783,
        "end_lineno": 788,
        "args": [
          "t"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "strong_title_match",
        "lineno": 798,
        "end_lineno": 802,
        "args": [
          "cand_title"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "artist_present",
        "lineno": 804,
        "end_lineno": 806,
        "args": [
          "cand_title",
          "uploader"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "duration_ok",
        "lineno": 808,
        "end_lineno": 813,
        "args": [
          "sc_seconds"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_search",
        "lineno": 821,
        "end_lineno": 832,
        "args": [
          "qs"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 870,
        "end_lineno": 880,
        "args": [
          "self",
          "token",
          "tracks_db_id",
          "csv_backup",
          "artists_db_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_headers",
        "lineno": 882,
        "end_lineno": 887,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "load_tracks_cache",
        "lineno": 889,
        "end_lineno": 899,
        "args": [
          "self"
        ],
        "docstring": "Load existing tracks from cache file.",
        "decorators": []
      },
      {
        "name": "save_tracks_cache",
        "lineno": 901,
        "end_lineno": 908,
        "args": [
          "self",
          "tracks"
        ],
        "docstring": "Save tracks to cache file.",
        "decorators": []
      },
      {
        "name": "update_tracks_cache",
        "lineno": 910,
        "end_lineno": 912,
        "args": [
          "self",
          "page_id",
          "track_data"
        ],
        "docstring": "Update a single track in the cache.",
        "decorators": []
      },
      {
        "name": "load_existing_tracks",
        "lineno": 914,
        "end_lineno": 976,
        "args": [
          "self"
        ],
        "docstring": "Load existing tracks from cache or Notion database.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_extract_track_data",
        "lineno": 978,
        "end_lineno": 1003,
        "args": [
          "self",
          "page"
        ],
        "docstring": "Extract track data from a Notion page.",
        "decorators": []
      },
      {
        "name": "_get_rich_text_value",
        "lineno": 1005,
        "end_lineno": 1009,
        "args": [
          "self",
          "prop"
        ],
        "docstring": "Extract value from rich_text property.",
        "decorators": []
      },
      {
        "name": "_get_title_value",
        "lineno": 1011,
        "end_lineno": 1015,
        "args": [
          "self",
          "prop"
        ],
        "docstring": "Extract value from title property.",
        "decorators": []
      },
      {
        "name": "_load_schema_cache",
        "lineno": 1017,
        "end_lineno": 1028,
        "args": [
          "self"
        ],
        "docstring": "Load schema cache from file if it exists and is recent.",
        "decorators": []
      },
      {
        "name": "_save_schema_cache",
        "lineno": 1030,
        "end_lineno": 1037,
        "args": [
          "self",
          "schema"
        ],
        "docstring": "Save schema cache to file.",
        "decorators": []
      },
      {
        "name": "get_database_schema",
        "lineno": 1039,
        "end_lineno": 1058,
        "args": [
          "self"
        ],
        "docstring": "Get database schema with caching.",
        "async": true,
        "decorators": []
      },
      {
        "name": "create_track_with_duplicate_detection",
        "lineno": 1060,
        "end_lineno": 1107,
        "args": [
          "self",
          "track",
          "spotify_data",
          "soundcloud_url",
          "duplicate_detector"
        ],
        "docstring": "Create a track with duplicate detection and automatic merging.",
        "async": true,
        "decorators": []
      },
      {
        "name": "normalize_text",
        "lineno": 1065,
        "end_lineno": 1070,
        "args": [
          "s"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "artist_overlap",
        "lineno": 1072,
        "end_lineno": 1075,
        "args": [
          "a",
          "b"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "duration_close",
        "lineno": 1077,
        "end_lineno": 1081,
        "args": [
          "ms1",
          "ms2"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "check_and_reprocess_incomplete_tracks",
        "lineno": 1109,
        "end_lineno": 1129,
        "args": [
          "self",
          "tracks_to_check"
        ],
        "docstring": "Check and reprocess tracks that are missing expected properties or players.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_create_new_track",
        "lineno": 1131,
        "end_lineno": 1235,
        "args": [
          "self",
          "track",
          "spotify_data",
          "soundcloud_url"
        ],
        "docstring": "Create a new track in Notion.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_add_embedded_player",
        "lineno": 1237,
        "end_lineno": 1280,
        "args": [
          "self",
          "page_id",
          "track",
          "spotify_data",
          "soundcloud_url"
        ],
        "docstring": "Add embedded player to the Notion page with priority: Spotify first, then SoundCloud.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_find_or_create_artist",
        "lineno": 1282,
        "end_lineno": 1334,
        "args": [
          "self",
          "artist_name"
        ],
        "docstring": "Find or create an artist page and return its ID.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_check_track_completeness",
        "lineno": 1336,
        "end_lineno": 1438,
        "args": [
          "self",
          "page_id",
          "track",
          "spotify_data",
          "soundcloud_url"
        ],
        "docstring": "Check if a track page has all expected properties and embedded players.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_reprocess_incomplete_track",
        "lineno": 1440,
        "end_lineno": 1501,
        "args": [
          "self",
          "page_id",
          "track",
          "spotify_data",
          "soundcloud_url"
        ],
        "docstring": "Reprocess a track that is missing expected properties or players.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_update_existing_track",
        "lineno": 1503,
        "end_lineno": 1546,
        "args": [
          "self",
          "page_id",
          "track",
          "spotify_data",
          "soundcloud_url"
        ],
        "docstring": "Update an existing track with new information.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_merge_duplicate_track",
        "lineno": 1548,
        "end_lineno": 1640,
        "args": [
          "self",
          "existing_page_id",
          "track",
          "spotify_data",
          "soundcloud_url",
          "confidence",
          "duplicate_detector"
        ],
        "docstring": "Merge a duplicate track with the existing track, combining data from both.",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 1649,
        "end_lineno": 1654,
        "args": [
          "self",
          "notion",
          "spotify",
          "soundcloud",
          "csv_backup"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "initialize_duplicate_detection",
        "lineno": 1656,
        "end_lineno": 1687,
        "args": [
          "self"
        ],
        "docstring": "Load existing tracks for duplicate detection.",
        "async": true,
        "decorators": []
      },
      {
        "name": "process_track_enhanced",
        "lineno": 1689,
        "end_lineno": 1753,
        "args": [
          "self",
          "track"
        ],
        "docstring": "Process a track with enhanced duplicate detection and data enrichment.",
        "async": true,
        "decorators": []
      },
      {
        "name": "process_all_spotify_tracks",
        "lineno": 1755,
        "end_lineno": 1890,
        "args": [
          "self"
        ],
        "docstring": "Process only the most recent 50 liked songs from Spotify with newest-first scanning and early stop.",
        "async": true,
        "decorators": []
      },
      {
        "name": "process_soundcloud_tracks",
        "lineno": 1892,
        "end_lineno": 2038,
        "args": [
          "self"
        ],
        "docstring": "Process SoundCloud tracks using yt-dlp to find recent tracks.",
        "async": true,
        "decorators": []
      },
      {
        "name": "check_existing_tracks_completeness",
        "lineno": 2040,
        "end_lineno": 2089,
        "args": [
          "self"
        ],
        "docstring": "Check existing tracks for completeness and reprocess incomplete ones.",
        "async": true,
        "decorators": []
      },
      {
        "name": "comprehensive_duplicate_scan_and_merge",
        "lineno": 2091,
        "end_lineno": 2217,
        "args": [
          "self"
        ],
        "docstring": "Comprehensive scan for duplicates among existing tracks and merge them.",
        "async": true,
        "decorators": []
      },
      {
        "name": "_archive_duplicate_page",
        "lineno": 2219,
        "end_lineno": 2236,
        "args": [
          "self",
          "page_id"
        ],
        "docstring": "Archive a duplicate page instead of deleting it.",
        "async": true,
        "decorators": []
      },
      {
        "name": "main_async",
        "lineno": 2246,
        "end_lineno": 2318,
        "args": [],
        "docstring": "Main async function with enhanced logging and error handling.",
        "async": true,
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "ColoredFormatter",
        "lineno": 181,
        "end_lineno": 203,
        "docstring": "Custom formatter with color coding for different log levels.",
        "bases": [
          "logging.Formatter"
        ]
      },
      {
        "name": "HeartbeatManager",
        "lineno": 217,
        "end_lineno": 265,
        "docstring": "Manages heartbeat updates for long-running operations.",
        "bases": []
      },
      {
        "name": "TrackSource",
        "lineno": 277,
        "end_lineno": 279,
        "docstring": null,
        "bases": [
          "Enum"
        ]
      },
      {
        "name": "Track",
        "lineno": 282,
        "end_lineno": 335,
        "docstring": "Enhanced track representation with duplicate detection support.",
        "bases": []
      },
      {
        "name": "DuplicateDetector",
        "lineno": 341,
        "end_lineno": 523,
        "docstring": "Advanced duplicate detection with multiple strategies.",
        "bases": []
      },
      {
        "name": "CSVBackupManager",
        "lineno": 529,
        "end_lineno": 642,
        "docstring": "Manages CSV backup of Notion database operations.",
        "bases": []
      },
      {
        "name": "AuthenticationError",
        "lineno": 647,
        "end_lineno": 649,
        "docstring": "Raised when an API returns 401 Unauthorized so callers can refresh tokens.",
        "bases": [
          "Exception"
        ]
      },
      {
        "name": "EnhancedSpotifyService",
        "lineno": 655,
        "end_lineno": 749,
        "docstring": "Enhanced Spotify API service with additional data fetching.",
        "bases": []
      },
      {
        "name": "SoundCloudService",
        "lineno": 755,
        "end_lineno": 861,
        "docstring": "Service for searching and extracting SoundCloud track information.",
        "bases": []
      },
      {
        "name": "EnhancedNotionService",
        "lineno": 867,
        "end_lineno": 1640,
        "docstring": "Enhanced Notion API service with duplicate detection and CSV backup.",
        "bases": []
      },
      {
        "name": "EnhancedMusicSyncOrchestrator",
        "lineno": 1646,
        "end_lineno": 2236,
        "docstring": "Enhanced orchestrator with duplicate detection and comprehensive tracking.",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/unified_music_workflow_fixed.py",
    "line_count": 908,
    "imports": [
      "__future__",
      "aiohttp",
      "asyncio",
      "dataclasses",
      "datetime",
      "difflib",
      "dotenv",
      "enum",
      "logging",
      "logging.handlers",
      "os",
      "pathlib",
      "random",
      "rapidfuzz",
      "spotify_oauth_manager",
      "sys",
      "time",
      "typing",
      "yt_dlp"
    ],
    "functions": [
      {
        "name": "__init__",
        "lineno": 78,
        "end_lineno": 85,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_valid_token",
        "lineno": 87,
        "end_lineno": 105,
        "args": [
          "self"
        ],
        "docstring": "Get a valid access token, refreshing if necessary",
        "decorators": []
      },
      {
        "name": "_fetch_json",
        "lineno": 111,
        "end_lineno": 144,
        "args": [
          "session",
          "method",
          "url",
          "headers",
          "params",
          "json_body",
          "max_retries"
        ],
        "docstring": null,
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 151,
        "end_lineno": 162,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_headers",
        "lineno": 164,
        "end_lineno": 169,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "find_track_by_spotify_id",
        "lineno": 171,
        "end_lineno": 185,
        "args": [
          "self",
          "spotify_id"
        ],
        "docstring": "Find existing track by Spotify ID",
        "async": true,
        "decorators": []
      },
      {
        "name": "find_or_create_artist",
        "lineno": 187,
        "end_lineno": 209,
        "args": [
          "self",
          "artist_name"
        ],
        "docstring": "Find existing artist by name or create new one",
        "async": true,
        "decorators": []
      },
      {
        "name": "create_artist",
        "lineno": 211,
        "end_lineno": 228,
        "args": [
          "self",
          "artist_name"
        ],
        "docstring": "Create a new artist page",
        "async": true,
        "decorators": []
      },
      {
        "name": "create_track_with_artists",
        "lineno": 230,
        "end_lineno": 300,
        "args": [
          "self",
          "track",
          "spotify_data",
          "soundcloud_url"
        ],
        "docstring": "Create track with artist relations and enhanced metadata",
        "async": true,
        "decorators": []
      },
      {
        "name": "update_track_soundcloud_url",
        "lineno": 302,
        "end_lineno": 312,
        "args": [
          "self",
          "page_id",
          "soundcloud_url"
        ],
        "docstring": "Update track's SoundCloud URL",
        "async": true,
        "decorators": []
      },
      {
        "name": "find_playlist_by_spotify_id",
        "lineno": 314,
        "end_lineno": 328,
        "args": [
          "self",
          "spotify_playlist_id"
        ],
        "docstring": "Find existing playlist by Spotify ID",
        "async": true,
        "decorators": []
      },
      {
        "name": "create_playlist",
        "lineno": 330,
        "end_lineno": 346,
        "args": [
          "self",
          "name",
          "spotify_playlist_id",
          "snapshot_id",
          "track_count",
          "total_duration_ms"
        ],
        "docstring": "Create a new playlist",
        "async": true,
        "decorators": []
      },
      {
        "name": "update_playlist_snapshot",
        "lineno": 348,
        "end_lineno": 358,
        "args": [
          "self",
          "page_id",
          "snapshot_id"
        ],
        "docstring": "Update playlist's snapshot ID",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_memberships_for_playlist",
        "lineno": 360,
        "end_lineno": 399,
        "args": [
          "self",
          "playlist_page_id"
        ],
        "docstring": "Return a mapping of Spotify Track ID -> membership page id for a given playlist page",
        "async": true,
        "decorators": []
      },
      {
        "name": "upsert_membership",
        "lineno": 401,
        "end_lineno": 421,
        "args": [
          "self",
          "playlist_page_id",
          "track_page_id",
          "position",
          "added_at_iso"
        ],
        "docstring": "Create or update playlist membership",
        "async": true,
        "decorators": []
      },
      {
        "name": "update_membership_present",
        "lineno": 423,
        "end_lineno": 433,
        "args": [
          "self",
          "membership_page_id",
          "present"
        ],
        "docstring": "Update membership present status",
        "async": true,
        "decorators": []
      },
      {
        "name": "update_track_playlist_relations",
        "lineno": 435,
        "end_lineno": 445,
        "args": [
          "self",
          "track_page_id",
          "playlist_page_ids"
        ],
        "docstring": "Update a track's playlist relations",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_track_current_playlists",
        "lineno": 447,
        "end_lineno": 458,
        "args": [
          "self",
          "track_page_id"
        ],
        "docstring": "Get current playlist relations for a track",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_state",
        "lineno": 460,
        "end_lineno": 481,
        "args": [
          "self",
          "key"
        ],
        "docstring": "Get sync state value",
        "async": true,
        "decorators": []
      },
      {
        "name": "set_state",
        "lineno": 483,
        "end_lineno": 521,
        "args": [
          "self",
          "key",
          "value"
        ],
        "docstring": "Set sync state value",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 528,
        "end_lineno": 531,
        "args": [
          "self",
          "token"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_liked_songs",
        "lineno": 533,
        "end_lineno": 546,
        "args": [
          "self",
          "limit",
          "offset"
        ],
        "docstring": "Get user's liked songs",
        "async": true,
        "decorators": []
      },
      {
        "name": "list_my_playlists",
        "lineno": 548,
        "end_lineno": 561,
        "args": [
          "self",
          "limit",
          "offset"
        ],
        "docstring": "Get user's playlists",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_playlist_items",
        "lineno": 563,
        "end_lineno": 592,
        "args": [
          "self",
          "playlist_id"
        ],
        "docstring": "Get playlist items with snapshot ID",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_track_details",
        "lineno": 594,
        "end_lineno": 605,
        "args": [
          "self",
          "track_id"
        ],
        "docstring": "Get detailed track information",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 612,
        "end_lineno": 613,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "search_async",
        "lineno": 615,
        "end_lineno": 653,
        "args": [
          "self",
          "track_name",
          "artist_name"
        ],
        "docstring": "Search SoundCloud for a track and return URL with confidence score",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 663,
        "end_lineno": 666,
        "args": [
          "self",
          "notion",
          "spotify",
          "soundcloud"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "process_track",
        "lineno": 668,
        "end_lineno": 698,
        "args": [
          "self",
          "track"
        ],
        "docstring": "Process a single track with enhanced relations",
        "async": true,
        "decorators": []
      },
      {
        "name": "sync_liked_songs",
        "lineno": 700,
        "end_lineno": 755,
        "args": [
          "self"
        ],
        "docstring": "Fetch all liked songs with pagination and incremental cutoff by added_at",
        "async": true,
        "decorators": []
      },
      {
        "name": "sync_playlists",
        "lineno": 757,
        "end_lineno": 852,
        "args": [
          "self"
        ],
        "docstring": "Sync all user playlists with enhanced relations",
        "async": true,
        "decorators": []
      },
      {
        "name": "run_batch",
        "lineno": 854,
        "end_lineno": 858,
        "args": [
          "self"
        ],
        "docstring": "Run the full sync process",
        "async": true,
        "decorators": []
      },
      {
        "name": "main_async",
        "lineno": 864,
        "end_lineno": 901,
        "args": [],
        "docstring": "Main async function",
        "async": true,
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 903,
        "end_lineno": 905,
        "args": [],
        "docstring": "Main function",
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "TrackSource",
        "lineno": 55,
        "end_lineno": 57,
        "docstring": null,
        "bases": [
          "str",
          "Enum"
        ]
      },
      {
        "name": "Track",
        "lineno": 64,
        "end_lineno": 71,
        "docstring": "A simple representation of a music track.",
        "bases": []
      },
      {
        "name": "SpotifyOAuthManager",
        "lineno": 77,
        "end_lineno": 105,
        "docstring": null,
        "bases": []
      },
      {
        "name": "NotionService",
        "lineno": 150,
        "end_lineno": 521,
        "docstring": null,
        "bases": []
      },
      {
        "name": "SpotifyService",
        "lineno": 527,
        "end_lineno": 605,
        "docstring": null,
        "bases": []
      },
      {
        "name": "SoundCloudService",
        "lineno": 611,
        "end_lineno": 653,
        "docstring": null,
        "bases": []
      },
      {
        "name": "MusicSyncOrchestrator",
        "lineno": 662,
        "end_lineno": 858,
        "docstring": null,
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/unified_music_workflow_working.py",
    "line_count": 525,
    "imports": [
      "__future__",
      "aiohttp",
      "asyncio",
      "dataclasses",
      "datetime",
      "difflib",
      "dotenv",
      "enum",
      "logging",
      "logging.handlers",
      "os",
      "random",
      "rapidfuzz",
      "typing",
      "yt_dlp"
    ],
    "functions": [
      {
        "name": "_fetch_json",
        "lineno": 95,
        "end_lineno": 131,
        "args": [
          "session",
          "method",
          "url",
          "headers",
          "params",
          "json_body",
          "max_retries"
        ],
        "docstring": "HTTP helper with retry logic.",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 136,
        "end_lineno": 145,
        "args": [
          "self",
          "token",
          "tracks_db_id"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "_headers",
        "lineno": 147,
        "end_lineno": 152,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "initialize_schemas",
        "lineno": 154,
        "end_lineno": 158,
        "args": [
          "self"
        ],
        "docstring": "Initialize all database schemas.",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_database_schema",
        "lineno": 160,
        "end_lineno": 165,
        "args": [
          "self",
          "database_id"
        ],
        "docstring": "Get current database schema.",
        "async": true,
        "decorators": []
      },
      {
        "name": "update_database_properties",
        "lineno": 167,
        "end_lineno": 172,
        "args": [
          "self",
          "database_id",
          "new_properties"
        ],
        "docstring": "Add new properties to database.",
        "async": true,
        "decorators": []
      },
      {
        "name": "ensure_track_properties",
        "lineno": 174,
        "end_lineno": 235,
        "args": [
          "self"
        ],
        "docstring": "Ensure track properties exist.",
        "async": true,
        "decorators": []
      },
      {
        "name": "ensure_playlist_properties",
        "lineno": 237,
        "end_lineno": 264,
        "args": [
          "self"
        ],
        "docstring": "Ensure playlist properties exist.",
        "async": true,
        "decorators": []
      },
      {
        "name": "find_track_by_spotify_id",
        "lineno": 266,
        "end_lineno": 276,
        "args": [
          "self",
          "spotify_id"
        ],
        "docstring": "Find track by Spotify ID.",
        "async": true,
        "decorators": []
      },
      {
        "name": "create_track",
        "lineno": 278,
        "end_lineno": 351,
        "args": [
          "self",
          "track",
          "soundcloud_url"
        ],
        "docstring": "Create track with available properties only.",
        "async": true,
        "decorators": []
      },
      {
        "name": "update_track_soundcloud_url",
        "lineno": 353,
        "end_lineno": 360,
        "args": [
          "self",
          "page_id",
          "url"
        ],
        "docstring": "Update SoundCloud URL if property exists.",
        "async": true,
        "decorators": []
      },
      {
        "name": "get_state",
        "lineno": 362,
        "end_lineno": 377,
        "args": [
          "self",
          "key"
        ],
        "docstring": "Get sync state.",
        "async": true,
        "decorators": []
      },
      {
        "name": "set_state",
        "lineno": 379,
        "end_lineno": 401,
        "args": [
          "self",
          "key",
          "value"
        ],
        "docstring": "Set sync state.",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 406,
        "end_lineno": 408,
        "args": [
          "self",
          "token"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "get_liked_songs",
        "lineno": 410,
        "end_lineno": 444,
        "args": [
          "self",
          "limit",
          "offset"
        ],
        "docstring": "Get liked songs.",
        "async": true,
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 449,
        "end_lineno": 455,
        "args": [
          "self"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "search",
        "lineno": 457,
        "end_lineno": 469,
        "args": [
          "self",
          "title",
          "artist"
        ],
        "docstring": "Search SoundCloud.",
        "decorators": []
      },
      {
        "name": "__init__",
        "lineno": 474,
        "end_lineno": 477,
        "args": [
          "self",
          "notion",
          "spotify",
          "soundcloud"
        ],
        "docstring": null,
        "decorators": []
      },
      {
        "name": "sync_liked_songs",
        "lineno": 479,
        "end_lineno": 497,
        "args": [
          "self",
          "limit"
        ],
        "docstring": "Sync liked songs.",
        "async": true,
        "decorators": []
      },
      {
        "name": "main",
        "lineno": 499,
        "end_lineno": 522,
        "args": [],
        "docstring": "Main entry point.",
        "async": true,
        "decorators": []
      }
    ],
    "classes": [
      {
        "name": "TrackSource",
        "lineno": 47,
        "end_lineno": 49,
        "docstring": null,
        "bases": [
          "str",
          "Enum"
        ]
      },
      {
        "name": "Track",
        "lineno": 52,
        "end_lineno": 93,
        "docstring": "Track representation with all metadata.",
        "bases": []
      },
      {
        "name": "NotionService",
        "lineno": 133,
        "end_lineno": 401,
        "docstring": "Notion service with automatic schema management.",
        "bases": []
      },
      {
        "name": "SpotifyService",
        "lineno": 403,
        "end_lineno": 444,
        "docstring": "Spotify service.",
        "bases": []
      },
      {
        "name": "SoundCloudService",
        "lineno": 446,
        "end_lineno": 469,
        "docstring": "SoundCloud service.",
        "bases": []
      },
      {
        "name": "MusicSyncOrchestrator",
        "lineno": 471,
        "end_lineno": 497,
        "docstring": "Main orchestrator.",
        "bases": []
      }
    ]
  },
  {
    "path": "/Users/brianhellemn/Library/Mobile Documents/com~apple~CloudDocs/OLD-SCRIPTS-ARCHIVE/MUSIC-BOT/unified_playlist_workflow_real.py",
    "line_count": 0,
    "imports": [],
    "functions": [],
    "classes": []
  }
]